<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>R package reviews {rsample} Effective Resampling for Machine Learning!</title>

  <meta property="description" itemprop="description" content="Let&#39;s learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We&#39;ll start with the question..."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-11-06"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-11-06"/>
  <meta name="article:author" content="Yury Zablotski"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="R package reviews {rsample} Effective Resampling for Machine Learning!"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Let&#39;s learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We&#39;ll start with the question..."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="R package reviews {rsample} Effective Resampling for Machine Learning!"/>
  <meta property="twitter:description" content="Let&#39;s learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We&#39;ll start with the question..."/>

  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","preview","output","bibliography","biblio-style","link-citations","linkcolor"]}},"value":[{"type":"character","attributes":{},"value":["R package reviews {rsample} Effective Resampling for Machine Learning!"]},{"type":"character","attributes":{},"value":["Let's learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We'll start with the question...\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Yury Zablotski"]},{"type":"character","attributes":{},"value":["https://yuzar-blog.netlify.app/"]}]}]},{"type":"character","attributes":{},"value":["November 06, 2022"]},{"type":"character","attributes":{},"value":["videos","statistics","models","machine learning","tidymodels","R package reviews"]},{"type":"character","attributes":{},"value":["thumbnail_rsample.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float","toc_depth","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[6]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["/Users/zablotski/Documents/library.bib"]},{"type":"character","attributes":{},"value":["apalike"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["blue"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["10Rcrossvalidation.png","3_techniques.png","b_cv_on_steroids.png","bootstrapping1.png","bootstrapping2.png","cross_validation.png","cv.png","overfitting.png","rsample_files/anchor-4.2.2/anchor.min.js","rsample_files/bowser-1.9.3/bowser.min.js","rsample_files/distill-2.2.21/template.v2.js","rsample_files/figure-html5/unnamed-chunk-2-1.png","rsample_files/figure-html5/unnamed-chunk-6-1.png","rsample_files/figure-html5/unnamed-chunk-7-1.png","rsample_files/figure-html5/unnamed-chunk-8-1.png","rsample_files/figure-html5/unnamed-chunk-9-1.png","rsample_files/header-attrs-2.16/header-attrs.js","rsample_files/jquery-3.6.0/jquery-3.6.0.js","rsample_files/jquery-3.6.0/jquery-3.6.0.min.js","rsample_files/jquery-3.6.0/jquery-3.6.0.min.map","rsample_files/popper-2.6.0/popper.min.js","rsample_files/tippy-6.2.7/tippy-bundle.umd.min.js","rsample_files/tippy-6.2.7/tippy-light-border.css","rsample_files/tippy-6.2.7/tippy.css","rsample_files/tippy-6.2.7/tippy.umd.min.js","rsample_files/vembedr-0.1.5/css/vembedr.css","rsample_files/webcomponents-2.0.0/webcomponents.js","Screenshot 2022-11-05 at 08.02.37.png","thumbnail_rsample.png","train_test.png","train_validate_test.png","validation1.png","validation2.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="rsample_files/header-attrs-2.16/header-attrs.js"></script>
  <link href="rsample_files/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
  <script src="rsample_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="rsample_files/popper-2.6.0/popper.min.js"></script>
  <link href="rsample_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="rsample_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="rsample_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="rsample_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="rsample_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="rsample_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="rsample_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"R package reviews {rsample} Effective Resampling for Machine Learning!","description":"Let's learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We'll start with the question...","authors":[{"author":"Yury Zablotski","authorURL":"https://yuzar-blog.netlify.app/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-11-06T00:00:00.000+01:00","citationText":"Zablotski, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>R package reviews {rsample} Effective Resampling for Machine Learning!</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">videos</div>
<div class="dt-tag">statistics</div>
<div class="dt-tag">models</div>
<div class="dt-tag">machine learning</div>
<div class="dt-tag">tidymodels</div>
<div class="dt-tag">R package reviews</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Let’s learn how to use three most important resampling techniques: train-test split, cross-validation and bootstrapping. We’ll start with the question…</p></p>
</div>

<div class="d-byline">
  Yury Zablotski <a href="https://yuzar-blog.netlify.app/" class="uri">https://yuzar-blog.netlify.app/</a> 
  
<br/>November 06, 2022
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#this-post-as-a-video" id="toc-this-post-as-a-video">This post as a video</a></li>
<li><a href="#why-do-we-actually-need-resampling" id="toc-why-do-we-actually-need-resampling">Why do we actually need resampling?</a></li>
<li><a href="#training-and-testing-sets" id="toc-training-and-testing-sets">Training and Testing sets</a>
<ul>
<li><a href="#random-resampling" id="toc-random-resampling">Random Resampling</a></li>
<li><a href="#stratified-resampling" id="toc-stratified-resampling">Stratified Resampling</a></li>
<li><a href="#breaks-argument" id="toc-breaks-argument">“breaks” argument</a></li>
<li><a href="#how-to-test-the-model" id="toc-how-to-test-the-model">How to test the model</a></li>
</ul></li>
<li><a href="#validation" id="toc-validation">Validation</a>
<ul>
<li><a href="#classic-validation" id="toc-classic-validation">Classic-Validation</a></li>
<li><a href="#v-fold-cross-validation" id="toc-v-fold-cross-validation">V-Fold Cross-Validation</a></li>
<li><a href="#vfold_cv-function" id="toc-vfold_cv-function"><em>vfold_cv()</em> function</a></li>
<li><a href="#workflow-for-regression-model" id="toc-workflow-for-regression-model"><em>workflow()</em> for regression model</a></li>
<li><a href="#v-fold-cross-validation-with-repeats" id="toc-v-fold-cross-validation-with-repeats">V-Fold Cross-Validation with “repeats”</a></li>
<li><a href="#workflow-for-classification-problem-with-random-forest" id="toc-workflow-for-classification-problem-with-random-forest"><em>workflow()</em> for classification problem with random forest</a></li>
<li><a href="#other-validation-techniques" id="toc-other-validation-techniques">Other validation techniques</a></li>
</ul></li>
<li><a href="#bootstrap-resampling" id="toc-bootstrap-resampling">Bootstrap Resampling</a></li>
<li><a href="#grouped-resampling" id="toc-grouped-resampling">Grouped Resampling</a></li>
<li><a href="#final-thoughts" id="toc-final-thoughts">Final thoughts</a></li>
<li><a href="#further-readings-and-references" id="toc-further-readings-and-references">Further readings and references</a></li>
</ul>
</nav>
</div>
<p><img src="3_techniques.png" /></p>
<h1 id="this-post-as-a-video">This post as a video</h1>
<p>I recommend to watch a video first, because I highlight things I talk about. It’s only 14 minutes long.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/GtAX7Y2F4aY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h1 id="why-do-we-actually-need-resampling">Why do we actually need resampling?</h1>
<p>The short answer is - resampling allows to create a useful model which helps to confidently answer any question with data. For example, if we want to know “Which cars are more efficient, American, European or Japanese?” we could take all 392 cars from Auto dataset and model miles per gallon for all 3 origins. Plotting predictions reveals that American cars are the least efficient, while Japanese are the most efficient. However, we can’t fully trust those predictions yet, because predictions which are based on <strong>the whole dataset can only reflect what the model already knows 🤓</strong>. While, if our model is somehow biased, overfitted or the model-assumptions are violated, our predictions might be just wrong. So, we need to somehow <strong>test</strong> the quality of those predictions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span></span>
<span><span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'>theme_test</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.statlearning.com'>ISLR</a></span><span class='op'>)</span>    <span class='co'># for Auto dataset</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>Auto</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 392   9</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>auto</span> <span class='op'>&lt;-</span> <span class='va'>Auto</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>origin <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span></span>
<span>    <span class='va'>origin</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='st'>"American"</span>, </span>
<span>    <span class='va'>origin</span> <span class='op'>==</span> <span class='fl'>2</span> <span class='op'>~</span> <span class='st'>"European"</span>, </span>
<span>    <span class='va'>origin</span> <span class='op'>==</span> <span class='fl'>3</span> <span class='op'>~</span> <span class='st'>"Japanese"</span> <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>origin</span>, <span class='va'>auto</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>   <span class='co'># I made a video on {sjPlot} 📦</span></span>
<span></span>
<span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>m</span>, type <span class='op'>=</span> <span class='st'>"pred"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$origin</code></pre>
<p><img src="rsample_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<h1 id="training-and-testing-sets">Training and Testing sets</h1>
<p><img src="train_test.png" /></p>
<h2 id="random-resampling">Random Resampling</h2>
<p>One way to validate our model is to <strong>split our data into two distinct datasets, the training set and the test set</strong>. That would allow you to develop and optimize the model with training dataset, and use test dataset to determine the efficiency of our model. The function <em>initial_split()</em> from {rsample} package splits data for you. Your just give it the name of your dataset and the proportion you want to allocate into the training set. 80% is usually a good choice. The <em>initial_split()</em> function then uses random sampling to get 80% of your data and if you need those 80% to be reproducible, use <em>set.seed()</em> function with the number of your choise before splitting. After the <em>initial_split()</em>, the <em>training()</em> and <em>testing()</em> functions return the actual data sets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rsample.tidymodels.org'>rsample</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>  <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>initial_split</a></span><span class='op'>(</span><span class='va'>auto</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span> <span class='op'>%&gt;%</span> <span class='fu'>glimpse</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 79
Columns: 9
$ mpg          &lt;dbl&gt; 18, 15, 18, 17, 14, 15, 22, 18, 25, 25, 16, 18,…
$ cylinders    &lt;dbl&gt; 8, 8, 8, 8, 8, 8, 6, 6, 4, 4, 6, 6, 8, 6, 4, 4,…
$ displacement &lt;dbl&gt; 307, 350, 318, 302, 455, 383, 198, 199, 110, 10…
$ horsepower   &lt;dbl&gt; 130, 165, 150, 140, 225, 170, 95, 97, 87, 95, 1…
$ weight       &lt;dbl&gt; 3504, 3693, 3436, 3449, 4425, 3563, 2833, 2774,…
$ acceleration &lt;dbl&gt; 12.0, 11.5, 11.0, 10.5, 10.0, 10.0, 15.5, 15.5,…
$ year         &lt;dbl&gt; 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 71, 71,…
$ origin       &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;, &quot;American&quot;,…
$ name         &lt;fct&gt; chevrolet chevelle malibu, buick skylark 320, p…</code></pre>
</div>
<h2 id="stratified-resampling">Stratified Resampling</h2>
<p>Such simple random sampling is often good enough, but when <strong>some groups of a categorical variable are much more common than others</strong>, a simple random sample may accidentally misrepresent proportions of those groups in the training or test set. For example 17% of our cars are European, while 20% are Japanese. So, we have 3% more Japanese cars as compared with European. But when we look at the testing set, we’ll see 5% less Japanese cars as compared with European cars, which is the opposite of what’s true.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sfirke/janitor'>janitor</a></span><span class='op'>)</span>       <span class='co'># I made a video on {janitor} 📦</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/janitor/man/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>auto</span><span class='op'>$</span><span class='va'>origin</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> auto$origin   n   percent
    American 245 0.6250000
    European  68 0.1734694
    Japanese  79 0.2015306</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/janitor/man/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>auto_test</span><span class='op'>$</span><span class='va'>origin</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> auto_test$origin  n   percent
         American 46 0.5822785
         European 19 0.2405063
         Japanese 14 0.1772152</code></pre>
</div>
<p>To avoid this, we can use <em>strata = </em> argument to conduct <strong>stratified random sampling</strong>, where splitting into 80 and 20 percents is conducted separately within each group, and then these sub-samples are combined into the overall training and test set. In this way, the proportions inside of groups will be kept similar to the original data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>   <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>initial_split</a></span><span class='op'>(</span><span class='va'>auto</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span>, strata <span class='op'>=</span> <span class='va'>origin</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/janitor/man/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>auto_test</span><span class='op'>$</span><span class='va'>origin</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> auto_test$origin  n   percent
         American 49 0.6202532
         European 14 0.1772152
         Japanese 16 0.2025316</code></pre>
</div>
<p>But what if an important variable is not categorical, but numeric? In this case we need to keep it’s distributions similar between the training and test set. Because otherwise, if the distribution of an important variable is skewed, simple random resampling may accidentally skew your data even further. (mVertigo effect on the plot below with some strange sound). We don’t want that!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="rsample_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>Fortunately, numeric data can also be easily <strong>stratified</strong>. The <em>initial_split()</em> function does it by artificially cutting (binning) numeric data into 4 quartiles and then uses stratified sampling for separate quartiles. For example, when we don’t stratify <em>horsepower of cars</em> (Funny Horse Picture with mVertigo Effect and Horse Whinny sound effect ;) … räuspern … sorry, the distribution of a training set (green) is similar to the original distribution (black), while the test set (red) differs in several locations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>   <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>initial_split</a></span><span class='op'>(</span><span class='va'>auto</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_train</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_test</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="rsample_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>But if we stratify for horsepower, the distribution of a training set almost overlaps with the original set, and the distribution of a test set gets much more similar to the original data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>   <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>initial_split</a></span><span class='op'>(</span><span class='va'>auto</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span>, strata <span class='op'>=</span> <span class='va'>horsepower</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_train</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_test</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="rsample_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<h2 id="breaks-argument">“breaks” argument</h2>
<p>By default, {rsample} will cut continuous variables into four parts, but we can increase the number of parts using the <em>breaks</em> argument in order to make distributions of training and test sets even more similar to the original data:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>   <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>initial_split</a></span><span class='op'>(</span><span class='va'>auto</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span>, strata <span class='op'>=</span> <span class='va'>horsepower</span>, breaks <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_train</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'>geom_density</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>auto_test</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>horsepower</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="rsample_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p><strong>And since there is no downside to using stratified sampling, I would always stratify sampling by the most important variable.</strong></p>
<h2 id="how-to-test-the-model">How to test the model</h2>
<p>Here is an example of the linear regression, which models miles-per-gallon of cars with their origin and horsepower. Important here is too see that we fit the model only with training data, and then use this model to predict the <em>mpg</em> in the test data. We’ll take only <strong>Root mean squared error</strong> and <strong>coefficient of determination</strong> <span class="math inline">\(R^2\)</span> as the prediction quality indicators. I say only, because there are many more, if you need other metrics. But for now the <span class="math inline">\(R^2\)</span> of 0.68 means that our model explains 68% of variation in the test data. I think it’s pretty good, but it’s subjective. If this code seems confusing, don’t sweat it, it’s not important for this topic. It just helps to learn about resampling.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># fit the model</span></span>
<span><span class='va'>lm_fit</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>linear_reg</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>'lm'</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>'regression'</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>fit</span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>origin</span> <span class='op'>*</span> <span class='va'>horsepower</span>, data <span class='op'>=</span> <span class='va'>auto_train</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># test performance of the model</span></span>
<span><span class='va'>test_results</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm_fit</span>, new_data <span class='op'>=</span> <span class='va'>auto_test</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>auto_test</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>ames_metrics</span> <span class='op'>&lt;-</span> <span class='fu'>metric_set</span><span class='op'>(</span><span class='va'>rsq</span><span class='op'>)</span> <span class='co'># options: "mae", "ccc" etc.</span></span>
<span><span class='fu'>ames_metrics</span><span class='op'>(</span><span class='va'>test_results</span>, truth <span class='op'>=</span> <span class='va'>mpg</span>, estimate <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rsq     standard       0.677</code></pre>
</div>
<p>What is important though, is to differentiate the <strong>Goodness-Of-Predictions (GoP)</strong> from the <strong>Goodness-Of-Fit (GoF)</strong>. The <strong>Goodness-Of-Predictions (GoP)</strong>, which is the <span class="math inline">\(R^2\)</span> we just got after using a test data, is a realistic estimate of model performance, because it was tested on the data our model have never seen. While the <strong>Goodness-Of-Fit (GoF)</strong>, which is the <span class="math inline">\(R^2\)</span> we get, when we fit our model to the whole “auto” dataset, will always result in an artificially optimistic, and therefore unrealistic, estimate of performance. The performance is unreaslistic, because some models are so good that they almost remember the data by hard, with all the noise and contaminations data contains. This phenomenon is called - overfitting and overfitted models are bad, because the noise our model have learned will result into great prediction on the training data and bad predictions on the test data.</p>
<p>By the way, here is a very useful free book about modelling, with code examples for both R and Python: <a href="https://ema.drwhy.ai/modelPerformance.html" class="uri">https://ema.drwhy.ai/modelPerformance.html</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>origin</span> <span class='op'>*</span> <span class='va'>horsepower</span>, data <span class='op'>=</span> <span class='va'>auto</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://easystats.github.io/performance/'>performance</a></span><span class='op'>)</span>   <span class='co'># I made a video on {performance} 📦</span></span>
<span><span class='fu'><a href='https://easystats.github.io/performance/reference/r2.html'>r2</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># R2 for Linear Regression
       R2: 0.683
  adj. R2: 0.679</code></pre>
</div>
<h1 id="validation">Validation</h1>
<h2 id="classic-validation">Classic-Validation</h2>
<p>So, we need to split the data in order to be able to properly evaluate model performance. But this produces another problem: <strong>How do we know whether the model we just trained is good?</strong> If we log-transform the data or add another predictor, we might be able to improve the Goodness-of-Predictions. Therefore, we need to understand the performance of a model before using the test set.</p>
<p><img src="validation1.png" /></p>
<p>And since <strong>it’s critical to use the test-set only once, at the end of model building</strong>, we need a second small set of data in order to compare different models we train. This second small data set is similar to the test set, but in order to avoid confusion, it was called - validation set.</p>
<p>Here is how it works: we can take our training set, which is 80% of the original data, and put let’s say 20% of it into a validation set. The 60% of the original data will be used for analysis. This validation set allows to stop the training, when the validation set error rate begins to rise. (make a plot in FCP where the curve of training error declines first and then increases) But I am not giving you any code example yet, because <strong>there is a much better way to use validation set</strong>.</p>
<p><img src="validation2.png" /></p>
<h2 id="v-fold-cross-validation">V-Fold Cross-Validation</h2>
<p>And this better way is - <strong>cross validation</strong> - which is one of the most popular resampling techniques. The working principle is very simple. Instead of cutting off 20% of the data from the training set as one validation set, we split the whole training set into, let’s say 4 validation sets (often called - folds) of 20% each.</p>
<p>We then use each validation set to evaluate the model analysed with the remaining 60% of the data. This produces 4 validations and when we take the average of them, we’ll get a much better idea about the quality of our model, as compared to only one validation set. Such resampling uncovers how well our model works before using the test set.</p>
<p><img src="cv.png" /></p>
<h2 id="vfold_cv-function"><em>vfold_cv()</em> function</h2>
<p>Programming cross-validation in tidymodels is incredibly easy. We’ll use the <em>vfold_cv()</em> function on the training set, and tell it how many folds do we want. Again, every validation set is similar to a test set, but was called a validation set to avoid confusion. And to avoid confusion between simple validation set and cross-validation, every fold which is used for validation - was called the <strong>assessment set</strong>, while remaining 3 folds were united to the <strong>analysis set</strong>. So, for every of the 4 folds, we’ll build a model with the analysis set, and then apply this model on the assessment set to estimate model performance. We then calculate the average performance statistics of 4 models.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='va'>folds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/vfold_cv.html'>vfold_cv</a></span><span class='op'>(</span><span class='va'>auto_train</span>, v <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='co'># 4-fold-cross-validation</span></span>
<span><span class='va'>folds</span><span class='op'>$</span><span class='va'>splits</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>&lt;Analysis/Assess/Total&gt;
&lt;232/78/310&gt;</code></pre>
</div>
<p>Zooming into a first fold will show that 232 observations will be used for the analysis, aka. creating the model, aka. training the model … Oh God it’s confusing! … while 78 observations will be used to assess aka. validate the performance of our model.</p>
<h2 id="workflow-for-regression-model"><em>workflow()</em> for regression model</h2>
<p>Here is how it works:</p>
<ul>
<li>we first <strong>set up a model</strong>, namely linear regression</li>
<li>we then create a <strong>workflow</strong>, add the model and the formula to it,</li>
<li>we then use <strong>fit_resamples()</strong> function to fit our 4 models. By the way, <strong>fit_resamples()</strong> function is similar to <strong>fit()</strong> function we used before, but instead of having a <em>data</em> argument, where we put a training set, <em>fit_resamples()</em> has <em>resamples</em> argument, where we put the folds object which contains our 4 resamples,</li>
<li>we’ll then use <em>collect_metrics()</em> function to get the average performance of our four fitted and validated models.</li>
</ul>
<p>Done! But if we want to see performance of all 4 separate models, we’ll specify <em>summarize = FALSE</em> argument inside of <em>collect_metrics()</em></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># set up a model</span></span>
<span><span class='va'>lm_fit</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>linear_reg</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>'lm'</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>'regression'</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># create a workflow</span></span>
<span><span class='va'>mpg_wf</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>lm_fit</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>add_formula</span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>origin</span> <span class='op'>*</span> <span class='va'>horsepower</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># fit models to folds</span></span>
<span><span class='va'>trained_models</span> <span class='op'>&lt;-</span> <span class='fu'>fit_resamples</span><span class='op'>(</span>object    <span class='op'>=</span> <span class='va'>mpg_wf</span>, </span>
<span>                                resamples <span class='op'>=</span> <span class='va'>folds</span> <span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 2 × 6
  .metric .estimator  mean     n std_err .config             
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard   4.47      4  0.246  Preprocessor1_Model1
2 rsq     standard   0.675     4  0.0299 Preprocessor1_Model1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span>summarize <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 8 × 5
  id    .metric .estimator .estimate .config             
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 Fold1 rmse    standard       4.48  Preprocessor1_Model1
2 Fold1 rsq     standard       0.681 Preprocessor1_Model1
3 Fold2 rmse    standard       3.87  Preprocessor1_Model1
4 Fold2 rsq     standard       0.743 Preprocessor1_Model1
5 Fold3 rmse    standard       5.08  Preprocessor1_Model1
6 Fold3 rsq     standard       0.597 Preprocessor1_Model1
7 Fold4 rmse    standard       4.43  Preprocessor1_Model1
8 Fold4 rsq     standard       0.677 Preprocessor1_Model1</code></pre>
</div>
<h2 id="v-fold-cross-validation-with-repeats">V-Fold Cross-Validation with “repeats”</h2>
<p>But while 4 folds are great for explaining cross-validation, are 4 folds enough to get a reliable mean performance metrics? Well, interestingly the 10 fold cross-validation proved to deliver the best results, and thus, became the default in the <em>vfold_cv()</em> function, so that when you don’t specify argument “v =”, your training set will automatically get 10 splits.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rsample.tidymodels.org/reference/vfold_cv.html'>vfold_cv</a></span><span class='op'>(</span><span class='va'>auto_train</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#  10-fold cross-validation 
# A tibble: 10 × 2
   splits           id    
   &lt;list&gt;           &lt;chr&gt; 
 1 &lt;split [279/31]&gt; Fold01
 2 &lt;split [279/31]&gt; Fold02
 3 &lt;split [279/31]&gt; Fold03
 4 &lt;split [279/31]&gt; Fold04
 5 &lt;split [279/31]&gt; Fold05
 6 &lt;split [279/31]&gt; Fold06
 7 &lt;split [279/31]&gt; Fold07
 8 &lt;split [279/31]&gt; Fold08
 9 &lt;split [279/31]&gt; Fold09
10 &lt;split [279/31]&gt; Fold10</code></pre>
</div>
<p>And while <strong>10-fold cross-validation</strong> is cool enough, it has one little downside. Namely, it might produce slightly “noisy”, or high-variance, estimates. To reduce such “noisy” variance, we can perform <strong>repeated cross-validation</strong>, which simply means running the <strong>10-fold cross-validation</strong> multiple times. For that, we can use the <em>repeats</em> argument inside of <em>vfold_cv()</em> function. Here, the default, and therefore not specified, 10-fold cross validation will be performed 10 times, which results in 100 models with 100 performance metrics, and therefore a less “noisy” average performance. This plot shows how quickly the standard error decreases with replicates:</p>
<figure>
<img src="10Rcrossvalidation.png" alt="Picture source - Tidymodels book: https://www.tmwr.org/resampling.html" />
<figcaption aria-hidden="true">Picture source - Tidymodels book: <a href="https://www.tmwr.org/resampling.html" class="uri">https://www.tmwr.org/resampling.html</a></figcaption>
</figure>
<h2 id="workflow-for-classification-problem-with-random-forest"><em>workflow()</em> for classification problem with random forest</h2>
<p>And since we just used regression model, let’s try out repeated cross-validation on a classification model. For that we’ll use a <em>random forest algorithm with 1000 trees</em> from the {ranger} package and classify <em>car origins</em> with the help of <em>mpg and horsepower</em>. (horse noise to wake up the viewers) The accuracy of 75% and the Area-Under-the-Curve (AUC_ROC) of 80% for such a small data set (of only 313 observations) is pretty good!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># get repeated cross-validation object</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='va'>folds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/vfold_cv.html'>vfold_cv</a></span><span class='op'>(</span><span class='va'>auto_train</span>, strata <span class='op'>=</span> <span class='va'>origin</span>, repeats <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='va'>folds</span></span></code></pre>
</div>
<pre><code>#  10-fold cross-validation repeated 10 times using stratification 
# A tibble: 100 × 3
   splits           id       id2   
   &lt;list&gt;           &lt;chr&gt;    &lt;chr&gt; 
 1 &lt;split [278/32]&gt; Repeat01 Fold01
 2 &lt;split [278/32]&gt; Repeat01 Fold02
 3 &lt;split [278/32]&gt; Repeat01 Fold03
 4 &lt;split [278/32]&gt; Repeat01 Fold04
 5 &lt;split [279/31]&gt; Repeat01 Fold05
 6 &lt;split [279/31]&gt; Repeat01 Fold06
 7 &lt;split [279/31]&gt; Repeat01 Fold07
 8 &lt;split [280/30]&gt; Repeat01 Fold08
 9 &lt;split [280/30]&gt; Repeat01 Fold09
10 &lt;split [281/29]&gt; Repeat01 Fold10
# … with 90 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># specify random forest model</span></span>
<span><span class='va'>rf_spec</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>rand_forest</span><span class='op'>(</span>trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"ranger"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># specify workflow</span></span>
<span><span class='va'>origin_wf</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>rf_spec</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_formula</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>origin</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>mpg</span> <span class='op'>*</span> <span class='va'>horsepower</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># fit models to folds</span></span>
<span><span class='va'>trained_models</span> <span class='op'>&lt;-</span> <span class='fu'>fit_resamples</span><span class='op'>(</span>object    <span class='op'>=</span> <span class='va'>origin_wf</span>, </span>
<span>                                resamples <span class='op'>=</span> <span class='va'>folds</span> <span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass 0.751   100 0.00646 Preprocessor1_Model1
2 roc_auc  hand_till  0.802   100 0.00691 Preprocessor1_Model1</code></pre>
</div>
<h2 id="other-validation-techniques">Other validation techniques</h2>
<p>And while {rsample} package has tons of other useful techniques like, Leave-One-Out (LOO) cross-validation, Monte Carlo cross-validation, time dependent or grouped resampling and many more (<a href="https://rsample.tidymodels.org/reference/index.html">scroll over this link</a>), let’s go to our last primary resampling technique - Bootstrap Resampling.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rsample.tidymodels.org/reference/loo_cv.html'>loo_cv</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rsample.tidymodels.org/reference/mc_cv.html'>mc_cv</a></span><span class='op'>(</span><span class='va'>auto_train</span>, prop <span class='op'>=</span> <span class='fl'>9</span><span class='op'>/</span><span class='fl'>10</span>, times <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>NOTE: <strong>Leave-one-out (LOO) cross-validation</strong> perform worse than almost any other method with lots of data and is computationally excessive, but <strong>might be useful with pathologically small samples</strong>, like experimental data.</p>
<h1 id="bootstrap-resampling">Bootstrap Resampling</h1>
<p><img src="b_cv_on_steroids.png" /></p>
<p>The <strong>bootstrap resampling</strong> is like cross-validation on steroids. A “bootstrap sample” is a sample, taken from the training set, and having <strong>the same size as the training set</strong>. The same size arises via <strong>replacements</strong>, where a particular observation might be sampled multiple times. Each observation has a 63% chance of being samples at least once, so that ca. 37% of the training set will not be selected for the analysis set and will therefore become the assessment set.</p>
<p><img src="bootstrapping1.png" /></p>
<p>But, as cool as bootstrap resampling is, similarly to cross-validation, it also has a little downside. And while a little downside of cross-validation is - high variance, a little downside of bootstrap resampling is - low-variance, which might result in slightly pessimistic estimates of model performance. For example, if model accuracy with all data is 80%, the bootstrap resampling would show the accuracy to be below 80%.</p>
<p>However, this decrease in accuracy is usually really small, and I personally prefer my estimates to be rather conservative and realistic, as opposed to overly optimistic, in order to avoid false positive results. So, I think, slightly conservative estimates can also be seen as small advantage.</p>
<p><img src="bootstrapping2.png" /></p>
<p>But the most decisive advantage of bootstrapping compared to cross-validation, is that bootstrapping not only checks <strong>model performance</strong>, but can also deliver <strong>robust estimates of model parameters with 50%, 95% or any other confidence intervals</strong>. Moreover, <strong>bootstrapping is one of the best nonparametric modelling techniques</strong>, with 4 solid reasons of why a bootstrapped model is better then usual model. So, knowing bootstrapping will definitely make you a better data scientist and if you want to know how to bootstrapp models in R in the next 10 minutes, check out <a href="https://youtu.be/sjCxIHVGkdE">this video</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>boot_samp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/bootstraps.html'>bootstraps</a></span><span class='op'>(</span><span class='va'>auto_train</span>, times <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># specify linear model</span></span>
<span><span class='va'>lm_spec</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>rand_forest</span><span class='op'>(</span>trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"ranger"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># workflow</span></span>
<span><span class='va'>mpg_wf</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>lm_spec</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_formula</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>origin</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>mpg</span> <span class='op'>*</span> <span class='va'>horsepower</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>fit_resamples</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>mpg_wf</span>, resamples <span class='op'>=</span> <span class='va'>boot_samp</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span>summarize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass 0.718    10 0.00806 Preprocessor1_Model1
2 roc_auc  hand_till  0.791    10 0.00916 Preprocessor1_Model1</code></pre>
</div>
<h1 id="grouped-resampling">Grouped Resampling</h1>
<p>If we have related observation, for example <strong>repeated measures</strong> from the same person, or data collected at different cities, we should assign all related observations to either the analysis or the assessment set as a group, to avoid having assessment data that’s closely related to the data used to fit a model. Grouped Resampling is especially relevant for multilevel models, also known as mixed-effects models.</p>
<p>Luckely for us, grouped resampling can be done with the same functions we just learned, but with the <strong>“group_” prefix</strong> before, for example <code>group_initial_split()</code>. We also need to use the argument <strong>group</strong> inside of the function, to specify which column has related observations. You can think of the <strong>group</strong> argument as the opposite of the <strong>strata</strong> argument.</p>
<p>Assigning the whole group to either analysis or assessment sets might screw-up proportions of those sets, especially if we have some small and some big groups. The functions, such as <code>group_vfold_cv()</code>, still try to balance the sets by default via <strong>randomly</strong> assigning groups and to balance the number of groups assigned to each fold. This means - we can still safely use <strong>repeated cross-validation</strong>, but if we want to balance the number of observations in each fold, instead of groups, you can use the argument <em>balance = “observations”</em>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/janitor/man/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>auto_train</span><span class='op'>$</span><span class='va'>year</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> auto_train$year  n    percent
              70 21 0.06774194
              71 21 0.06774194
              72 23 0.07419355
              73 32 0.10322581
              74 21 0.06774194
              75 27 0.08709677
              76 25 0.08064516
              77 24 0.07741935
              78 27 0.08709677
              79 23 0.07419355
              80 22 0.07096774
              81 21 0.06774194
              82 23 0.07419355</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>  <span class='co'># for reproducibility</span></span>
<span><span class='va'>auto_split</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>group_initial_split</a></span><span class='op'>(</span><span class='va'>auto_train</span>, prop <span class='op'>=</span> <span class='fl'>0.8</span>, group <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>auto_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>training</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span><span class='va'>auto_test</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/initial_split.html'>testing</a></span><span class='op'>(</span><span class='va'>auto_split</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='va'>folds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/group_vfold_cv.html'>group_vfold_cv</a></span><span class='op'>(</span><span class='va'>auto_train</span>, v <span class='op'>=</span> <span class='fl'>4</span>, repeats <span class='op'>=</span> <span class='fl'>4</span>,  group <span class='op'>=</span> <span class='va'>year</span>, balance <span class='op'>=</span> <span class='st'>"observations"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># specify linear model</span></span>
<span><span class='va'>lm_spec</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>rand_forest</span><span class='op'>(</span>trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"ranger"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"classification"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># workflow</span></span>
<span><span class='va'>mpg_wf</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>lm_spec</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>add_formula</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>origin</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>mpg</span> <span class='op'>*</span> <span class='va'>horsepower</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># fit models to folds</span></span>
<span><span class='va'>trained_models</span> <span class='op'>&lt;-</span> <span class='fu'>fit_resamples</span><span class='op'>(</span>object    <span class='op'>=</span> <span class='va'>mpg_wf</span>, </span>
<span>                                resamples <span class='op'>=</span> <span class='va'>folds</span> <span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass 0.705    16 0.00983 Preprocessor1_Model1
2 roc_auc  hand_till  0.764    16 0.0134  Preprocessor1_Model1</code></pre>
</div>
<p><em>Group_bootstraps()</em> is also easy to apply for related observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>boot_samp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rsample.tidymodels.org/reference/group_bootstraps.html'>group_bootstraps</a></span><span class='op'>(</span><span class='va'>auto_train</span>, times <span class='op'>=</span> <span class='fl'>2</span>, group <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>fit_resamples</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>mpg_wf</span>, resamples <span class='op'>=</span> <span class='va'>boot_samp</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>trained_models</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>collect_metrics</span><span class='op'>(</span>summarize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass 0.738     2  0.0158 Preprocessor1_Model1
2 roc_auc  hand_till  0.767     2  0.0438 Preprocessor1_Model1</code></pre>
</div>
<h1 id="final-thoughts">Final thoughts</h1>
<p>And while some statisticians avoid splitting the data, because they believe all of the data should be used for parameter estimation, it is a good modeling practice to have an unbiased set of observations as the final arbiter of model quality. <strong>A test set should be avoided only when the data are pathologically small.</strong> But, when training a final chosen model for production, after ascertaining the expected performance on new data, practitioners often use all available data for better parameter estimation.</p>
<p><strong>It is critical to look at the test set only once; otherwise, it becomes part of the modeling process.</strong></p>
<h1 id="further-readings-and-references">Further readings and references</h1>
<ul>
<li><p>Here is the documentation of the {rsample} package with several articles: <a href="https://rsample.tidymodels.org/index.html" class="uri">https://rsample.tidymodels.org/index.html</a></p></li>
<li><p>Here are all the functions from {rsample} package: <a href="https://rsample.tidymodels.org/reference/index.html" class="uri">https://rsample.tidymodels.org/reference/index.html</a></p></li>
<li><p>Chapter from Tidymodels book: <a href="https://www.tmwr.org/resampling.html" class="uri">https://www.tmwr.org/resampling.html</a></p></li>
</ul>
<hr />
<p>If you think, I missed something, please comment on it, and I’ll improve this tutorial.</p>
<p><strong>Thank you for learning!</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
