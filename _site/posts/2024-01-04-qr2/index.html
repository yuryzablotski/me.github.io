<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>yuzaR-Blog: Unleash Quantile Regression Results</title>

<meta property="description" itemprop="description" content="In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)"/>

<link rel="canonical" href="https://me.github.io/posts/2024-01-04-qr2/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2024-01-14"/>
<meta property="article:created" itemprop="dateCreated" content="2024-01-14"/>
<meta name="article:author" content="Yury Zablotski"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="yuzaR-Blog: Unleash Quantile Regression Results"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)"/>
<meta property="og:url" content="https://me.github.io/posts/2024-01-04-qr2/"/>
<meta property="og:image" content="https://me.github.io/posts/2024-01-04-qr2/thumbnail_QR2.png"/>
<meta property="og:image:width" content="1920"/>
<meta property="og:image:height" content="1080"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="yuzaR-Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="yuzaR-Blog: Unleash Quantile Regression Results"/>
<meta property="twitter:description" content="In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)"/>
<meta property="twitter:url" content="https://me.github.io/posts/2024-01-04-qr2/"/>
<meta property="twitter:image" content="https://me.github.io/posts/2024-01-04-qr2/thumbnail_QR2.png"/>
<meta property="twitter:image:width" content="1920"/>
<meta property="twitter:image:height" content="1080"/>
<meta property="twitter:site" content="@yuzaR___"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="yuzaR-Blog: Unleash Quantile Regression Results"/>
<meta name="citation_fulltext_html_url" content="https://me.github.io/posts/2024-01-04-qr2/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2024/01/14"/>
<meta name="citation_publication_date" content="2024/01/14"/>
<meta name="citation_author" content="Yury Zablotski"/>
<!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","categories","preview","output","bibliography","biblio-style","link-citations","linkcolor","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Unleash Quantile Regression Results"]},{"type":"character","attributes":{},"value":["In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Yury Zablotski"]},{"type":"character","attributes":{},"value":["https://yuzar-blog.netlify.app/"]}]}]},{"type":"character","attributes":{},"value":["January 14, 2024"]},{"type":"character","attributes":{},"value":["videos","statistics","visualization"]},{"type":"character","attributes":{},"value":["thumbnail_QR2.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float","toc_depth","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[6]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["/Users/zablotski/Documents/library.bib"]},{"type":"character","attributes":{},"value":["apalike"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["blue"]},{"type":"character","attributes":{},"value":["https://me.github.io/posts/2024-01-04-qr2/"]},{"type":"character","attributes":{},"value":["https://me.github.io/posts/2024-01-04-qr2/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["age.png","fancy_table.docx","fancy_table.png","preds_all_models.png","qr_all_age.png","qr2_files/anchor-4.2.2/anchor.min.js","qr2_files/bowser-1.9.3/bowser.min.js","qr2_files/distill-2.2.21/template.v2.js","qr2_files/figure-html5/unnamed-chunk-11-1.png","qr2_files/figure-html5/unnamed-chunk-12-1.png","qr2_files/figure-html5/unnamed-chunk-14-1.png","qr2_files/figure-html5/unnamed-chunk-16-1.png","qr2_files/figure-html5/unnamed-chunk-18-1.png","qr2_files/figure-html5/unnamed-chunk-18-2.png","qr2_files/figure-html5/unnamed-chunk-2-1.png","qr2_files/figure-html5/unnamed-chunk-21-1.png","qr2_files/figure-html5/unnamed-chunk-24-1.png","qr2_files/figure-html5/unnamed-chunk-25-1.png","qr2_files/figure-html5/unnamed-chunk-27-1.png","qr2_files/figure-html5/unnamed-chunk-3-1.png","qr2_files/figure-html5/unnamed-chunk-31-1.png","qr2_files/figure-html5/unnamed-chunk-32-1.png","qr2_files/figure-html5/unnamed-chunk-33-1.png","qr2_files/figure-html5/unnamed-chunk-34-1.png","qr2_files/figure-html5/unnamed-chunk-4-1.png","qr2_files/figure-html5/unnamed-chunk-5-1.png","qr2_files/header-attrs-2.25/header-attrs.js","qr2_files/jquery-3.6.0/jquery-3.6.0.js","qr2_files/jquery-3.6.0/jquery-3.6.0.min.js","qr2_files/jquery-3.6.0/jquery-3.6.0.min.map","qr2_files/popper-2.6.0/popper.min.js","qr2_files/tabwid-1.1.3/tabwid.css","qr2_files/tabwid-1.1.3/tabwid.js","qr2_files/tippy-6.2.7/tippy-bundle.umd.min.js","qr2_files/tippy-6.2.7/tippy-light-border.css","qr2_files/tippy-6.2.7/tippy.css","qr2_files/tippy-6.2.7/tippy.umd.min.js","qr2_files/vembedr-0.1.5/css/vembedr.css","qr2_files/webcomponents-2.0.0/webcomponents.js","sjPlot_age.png","thumbnail_QR2.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */





html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       25px;
  --text-color:       white;
  --text-size:        25px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
  font-weight: bold;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <link href="../../site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
  <link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
  <script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-Q28WX9Y4VS"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Q28WX9Y4VS');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Unleash Quantile Regression Results","description":"In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)","authors":[{"author":"Yury Zablotski","authorURL":"https://yuzar-blog.netlify.app/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-01-14T00:00:00.000+01:00","citationText":"Zablotski, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../images/my_foto.jpg" alt="Logo"/>
</a>
<a href="../../index.html" class="title">yuzaR-Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../about.html">ABOUT</a>
<a href="../../index.html">POSTS</a>
<a href="../../consulting.html">CONSULTING</a>
<a href="https://www.youtube.com/channel/UCcGXGFClRdnrwXsPHi7P4ZA">
<i class="fa fa-youtube-square" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/yuzaR___">
<i class="fa fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/dr-yury-zablotski-3765b378/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="https://github.com/yuryzablotski/yuzaR-Blog">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://koji.to/yuzaR">LEAVE A TIP</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Unleash Quantile Regression Results</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:videos" class="dt-tag">videos</a>
  <a href="../../index.html#category:statistics" class="dt-tag">statistics</a>
  <a href="../../index.html#category:visualization" class="dt-tag">visualization</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>In the previous episode, I presented four reasons why Quantile Regression (QR) is a better alternative to classic linear regression. However, I discovered that reporting QR results can be quite demanding. To make the process easier, I created better plots for model estimates and predictions, a comprehensive table of model results, including contrasts between groups and p-values. I found this code so useful that I thought you guys might benefit from it too. Besides, I really enjoyed programming it :)</p></p>
</div>

<div class="d-byline">
  Yury Zablotski <a href="https://yuzar-blog.netlify.app/" class="uri">https://yuzar-blog.netlify.app/</a> 
  
<br/>January 14, 2024
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#this-post-as-ca.-18-minutes-video" id="toc-this-post-as-ca.-18-minutes-video">This post as ca. 18 minutes video</a></li>
<li><a href="#get-3-most-importance-quantiles" id="toc-get-3-most-importance-quantiles">Get 3 most importance quantiles</a></li>
<li><a href="#get-all-quantiles" id="toc-get-all-quantiles">Get all quantiles</a></li>
<li><a href="#get-tidy-results-of-multivariable-models" id="toc-get-tidy-results-of-multivariable-models">Get tidy results of multivariable models</a></li>
<li><a href="#create-a-fancy-plot-step-by-step" id="toc-create-a-fancy-plot-step-by-step">Create a fancy plot step by step</a>
<ul>
<li><a href="#filter-out-one-predictor" id="toc-filter-out-one-predictor">1. Filter out one predictor</a></li>
<li><a href="#plot-all-quantiles" id="toc-plot-all-quantiles">2. Plot all quantiles</a></li>
<li><a href="#put-intercept-on-top-of-the-plot" id="toc-put-intercept-on-top-of-the-plot">3. Put intercept on top of the plot</a></li>
<li><a href="#put-linear-model-results-on-the-plot" id="toc-put-linear-model-results-on-the-plot">4. Put linear model results on the plot</a></li>
<li><a href="#put-three-most-important-quantiles-on-the-plot" id="toc-put-three-most-important-quantiles-on-the-plot">5. Put three most important quantiles on the plot</a></li>
</ul></li>
<li><a href="#create-a-function-to-automate-plot-creation" id="toc-create-a-function-to-automate-plot-creation">Create a function to automate plot creation</a>
<ul>
<li><a href="#use-this-function" id="toc-use-this-function">Use this function</a></li>
<li><a href="#effect-size-of-all-concfounders" id="toc-effect-size-of-all-concfounders">Effect size of all concfounders</a></li>
</ul></li>
<li><a href="#unleash-the-power-of-contrasts-with-emmeans" id="toc-unleash-the-power-of-contrasts-with-emmeans">Unleash the power of contrasts with {emmeans}</a>
<ul>
<li><a href="#get-table-of-predictions-for-every-tau" id="toc-get-table-of-predictions-for-every-tau">Get table of predictions for every tau</a></li>
<li><a href="#plot-predictions-of-every-tau" id="toc-plot-predictions-of-every-tau">Plot predictions of every tau</a></li>
<li><a href="#interactions-also-work-not-part-of-the-video-since-too-much" id="toc-interactions-also-work-not-part-of-the-video-since-too-much">Interactions also work (not part of the video, since too much)</a></li>
<li><a href="#prepare-predictions-of-all-models-to-add-ols-results" id="toc-prepare-predictions-of-all-models-to-add-ols-results">Prepare predictions of all models to add OLS results</a></li>
<li><a href="#plot-predictions-of-all-models-ols-qr" id="toc-plot-predictions-of-all-models-ols-qr">Plot predictions of all models OLS &amp; QR</a></li>
<li><a href="#get-fancy-table-for-your-publication" id="toc-get-fancy-table-for-your-publication">Get fancy table for your publication</a></li>
</ul></li>
<li><a href="#whats-nest" id="toc-whats-nest">What’s nest</a></li>
<li><a href="#visualizing-contrasts-it-might-be-an-overkill-so-its-not-part-of-the-video-but-why-not" id="toc-visualizing-contrasts-it-might-be-an-overkill-so-its-not-part-of-the-video-but-why-not">Visualizing contrasts (it might be an overkill, so, it’s not part of the video, but why not?)</a></li>
</ul>
</nav>
</div>
<h1 id="this-post-as-ca.-18-minutes-video">This post as ca. 18 minutes video</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/4nJD2tpZFDs" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h1 id="get-3-most-importance-quantiles">Get 3 most importance quantiles</h1>
<p>We’ll use the Wage dataset from the ISLR package to study the influence of job type, age, and education on American salaries. We first create four simple models: one classic linear regression that calculates average wages, and three quantile regressions. The low quantile (tau = 0.1) calculates wages of low earners, the median quantile (tau = 0.5) gets median wages, and the high quantile (tau = 0.9) describes wages of top 10% earners. We will then use the {sjPlot} package to plot estimates of these four models for all predictors at the same time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>      <span class='co'># use &amp; thank me later ;)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.statlearning.com'>ISLR</a></span><span class='op'>)</span>           <span class='co'># provides Wage dataset</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_test</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># beautifies plots</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.r-project.org'>quantreg</a></span><span class='op'>)</span> <span class='co'># extra video on my channel</span></span>
<span><span class='va'>lr</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span>, <span class='va'>Wage</span><span class='op'>)</span></span>
<span><span class='va'>qr10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span></span>
<span><span class='va'>qr50</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='va'>qr90</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>   <span class='co'># extra video on my channel</span></span>
<span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_models.html'>plot_models</a></span><span class='op'>(</span><span class='va'>lr</span>, <span class='va'>qr10</span>, <span class='va'>qr50</span>, <span class='va'>qr90</span>, </span>
<span>            show.values <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>            m.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LR"</span>, <span class='st'>"QR 10%"</span>, <span class='st'>"QR 50%"</span>, <span class='st'>"QR 90%"</span><span class='op'>)</span>, </span>
<span>            legend.title <span class='op'>=</span> <span class='st'>"Model type"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>While this plot allows us to compare results among models, different predictors usually have very different magnitudes of estimates. High estimates are displayed in a better way, while low estimates are underrepresented and hard to see. This problem could be solved with a single line of code by using the “rm.terms” (remove terms) argument. However, when we have many predictors and many categories per predictor, this solution becomes very inconvenient. To be honest, it can become a huge pain in the neck.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_models.html'>plot_models</a></span><span class='op'>(</span><span class='va'>lr</span>, <span class='va'>qr10</span>, <span class='va'>qr50</span>, <span class='va'>qr90</span>, </span>
<span>            rm.terms <span class='op'>=</span> <span class='st'>"jobclass [2. Information]"</span>,</span>
<span>            show.values <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>            m.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LR"</span>, <span class='st'>"QR 10%"</span>, <span class='st'>"QR 50%"</span>, <span class='st'>"QR 90%"</span><span class='op'>)</span>, </span>
<span>            legend.title <span class='op'>=</span> <span class='st'>"Model type"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>So, if you are only interested in a few important quantiles and have models with a low number of predictors, then the plot_model() function is the way to go. However, if you want to explore the entire distribution of quantiles, creating a new model for every quantile would be necessary. This approach would result in too much code and the plot might look cluttered with too many estimates.</p>
<h1 id="get-all-quantiles">Get all quantiles</h1>
<p>A more elegant solution for obtaining more quantiles is to use the “tau” argument with a sequence of quantiles of your choice. This way, we can easily create multiple models at once, say 20. Using the “summary” and “plot” functions would allow us to plot all predictors for all quantiles simultaneously. However, this visualization is hardly customizable and we cannot include estimates or p-values like {sjPlot} did.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>qr_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span>, <span class='va'>Wage</span>, </span>
<span>             tau  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.05</span>, <span class='fl'>.95</span>, by <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>qr_all</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>To address this issue, I developed the idea of combining the visual results of {sjPlot} and {quantreg} in order to create beautiful and highly customizable plot. To do that, we need two tidy datasets – one containing the quantile regression model results and the other comprising the linear regression model results. This approach is necessary because, despite the fact that the linear regression results are plotted in red by the {quantreg} package, which means that they have been calculated, I could not extract them from the model. If you know how, please put the solution in the comments below for the whole community.</p>
<div class="layout-chunk" data-layout="l-screen">
<p><img src="qr2_files/figure-html5/unnamed-chunk-5-1.png" width="1824" /></p>
</div>
<h1 id="get-tidy-results-of-multivariable-models">Get tidy results of multivariable models</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lr</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Call:
lm(formula = wage ~ jobclass + age, data = Wage)

Residuals:
     Min       1Q   Median       3Q      Max 
-107.234  -24.751   -6.311   16.308  197.278 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             76.6298     2.8320   27.06   &lt;2e-16 ***
jobclass2. Information  15.9214     1.4732   10.81   &lt;2e-16 ***
age                      0.6447     0.0638   10.11   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 40.16 on 2997 degrees of freedom
Multiple R-squared:  0.07435,   Adjusted R-squared:  0.07373 
F-statistic: 120.4 on 2 and 2997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>We need to tidy up model results because the classic summary() function of any model does not produce them. For that, we will use, suprise suprise, the tidy() function from the {rstatix} package. Here, it is important to use the se.type = “nid” argument because otherwise, the default option of tidy() (se.type = “rank”) would produce slightly different confidence intervals (CIs) compared to {sjPlot} CIs, which would then not match on the plot. Having only Standard-Error will allow us to calculate 95% CIs on our terms! So, we would feel more powerful and in control. (some ironic picture of powerful personality, like Held in unterhose)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lr_preds</span> <span class='op'>&lt;-</span> <span class='va'>lr</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>se.type <span class='op'>=</span> <span class='st'>"nid"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'># se.type = "rank"</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>LCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>-</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span>, </span>
<span>         UCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>+</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://rpkgs.datanovia.com/rstatix/reference/add_significance.html'>add_significance</a></span><span class='op'>(</span><span class='st'>"p.value"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>!=</span> <span class='st'>"(Intercept)"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>std.error</span>, <span class='op'>-</span><span class='va'>statistic</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p.value.signif</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qr_preds</span> <span class='op'>&lt;-</span> <span class='va'>qr_all</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>se.type <span class='op'>=</span> <span class='st'>"nid"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>LCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>-</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span>, </span>
<span>         UCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>+</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"Intercept"</span>, <span class='va'>term</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://rpkgs.datanovia.com/rstatix/reference/add_significance.html'>add_significance</a></span><span class='op'>(</span><span class='st'>"p.value"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>std.error</span>, <span class='op'>-</span><span class='va'>statistic</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p.value.signif</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We then remove the intercept because there is a better way to deal with it and we’ll come to it in a moment. To do so, we can filter the intercept out using the exclamation mark. However, intercepts are often written in a strange way, with brackets for example, which can be confusing. Therefore, we can use the “grepl” function to get rid of it. The “grepl” function searches for matches to the pattern we specify. In our case, the word “intercept” itself is the pattern. (Note that “grepl” also takes missing values in our variable “term” as not matching a non-missing pattern.)</p>
<p>Finally, we can use the “add_significance” function from the {rstatix} package to add significance stars as a new column. Here’s a quick interpretation of the stars:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="tabwid"><style>.cl-d4b29b4e{}.cl-d49e01e8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d49e01fc{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(153, 153, 153, 1.00);background-color:transparent;}.cl-d4a42438{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d4a44e5e{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e72{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e73{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e7c{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e86{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e87{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e90{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e91{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e9a{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4a44e9b{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-d4b29b4e'><thead><tr style="overflow-wrap:break-word;"><th class="cl-d4a44e5e"><p class="cl-d4a42438"><span class="cl-d49e01e8">Stars</span></p></th><th class="cl-d4a44e72"><p class="cl-d4a42438"><span class="cl-d49e01e8">P-value Interpretation</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-d4a44e73"><p class="cl-d4a42438"><span class="cl-d49e01fc">character</span></p></th><th class="cl-d4a44e7c"><p class="cl-d4a42438"><span class="cl-d49e01fc">character</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d4a44e86"><p class="cl-d4a42438"><span class="cl-d49e01e8">ns</span></p></td><td class="cl-d4a44e87"><p class="cl-d4a42438"><span class="cl-d49e01e8">p ≥ 0.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4a44e86"><p class="cl-d4a42438"><span class="cl-d49e01e8">*</span></p></td><td class="cl-d4a44e87"><p class="cl-d4a42438"><span class="cl-d49e01e8">p &lt; 0.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4a44e86"><p class="cl-d4a42438"><span class="cl-d49e01e8">**</span></p></td><td class="cl-d4a44e87"><p class="cl-d4a42438"><span class="cl-d49e01e8">p &lt; 0.01</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4a44e86"><p class="cl-d4a42438"><span class="cl-d49e01e8">***</span></p></td><td class="cl-d4a44e87"><p class="cl-d4a42438"><span class="cl-d49e01e8">p &lt; 0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4a44e90"><p class="cl-d4a42438"><span class="cl-d49e01e8">****</span></p></td><td class="cl-d4a44e91"><p class="cl-d4a42438"><span class="cl-d49e01e8">p = 0</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-d4a44e9a"><p class="cl-d4a42438"><span class="cl-d49e01e8">n: 5</span></p></td></tr></tfoot></table></div>
</div>
<p>By the way, the double colon is a convenient way to use only one particular function from a specific package. For instance, in this case, I don’t need to use the {rstatix} package anymore. Using the double colon takes less memory on a computer and produces fewer conflicts. For example, the “tidy” function is present in three different packages. But I digress, so, let’s get back to the topic at hand.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='op'>?</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Help on topic &#39;tidy&#39; was found in the following packages:

  Package               Library
  rstatix               /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library
  broom                 /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library
  generics              /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library


Using the first match ...</code></pre>
</div>
<p>Finally, we remove unnecessary columns from our tidy dataset and rename the p-value column. We are now ready to produce our beautiful and informative plot.</p>
<h1 id="create-a-fancy-plot-step-by-step">Create a fancy plot step by step</h1>
<p>To ensure maximum clarity and learning, let’s program that fancy plot step-by-step.</p>
<h2 id="filter-out-one-predictor">1. Filter out one predictor</h2>
<p>First, we’ll focus on one predictor at a time. Let’s filter out the predictor ‘age’ and produce two smaller tidy datasets, one for linear regression and another for quantile regression.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data_lm</span> <span class='op'>=</span> <span class='va'>lr_preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>==</span> <span class='st'>"age"</span><span class='op'>)</span></span>
<span><span class='va'>data_qr</span> <span class='op'>=</span> <span class='va'>qr_preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>==</span> <span class='st'>"age"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="plot-all-quantiles">2. Plot all quantiles</h2>
<p>To plot the estimates of QR and their 95% CIs, we’ll use a “ggplot” command with classic “geom_point”, “geom_line” and “geom_ribbon” functions. We’ll display all possible tau values on the x axis and finally, we’ll flip the coordinates in order to make this plot similar to {sjPlots} solution. It looks much nicer than the grey plot, doesn’t it? :)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>q_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data_qr</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tau</span>, y <span class='op'>=</span> <span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span> color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>UCL</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"green"</span>, alpha <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_reverse</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>q_plot</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h2 id="put-intercept-on-top-of-the-plot">3. Put intercept on top of the plot</h2>
<p>Another disadvantage of the grey plot is that it sometimes doesn’t show the intercept for some predictors. For example, it doesn’t show the intercept for “age,” but it does for “jobclass.” We’ll fix this by using the “geom_hline” function to always put the Intercept on our plot. This will display the strength of the evidence against the null hypothesis. The further our estimates are from the intercept, the stronger evidence we have against the null hypothesis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># yintercept instead of xintercept because the plot is flipped</span></span>
<span><span class='va'>q_plot2</span> <span class='op'>&lt;-</span> <span class='va'>q_plot</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, alpha <span class='op'>=</span> <span class='fl'>.3</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>q_plot2</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<h2 id="put-linear-model-results-on-the-plot">4. Put linear model results on the plot</h2>
<p>The next step is to put linear model results on our plot with “geom_line” and “annotate” functions. Here, we could have used the numbers from the dataset directly. But imagine that you need to do this for 10 or 20 predictors, and you’ll see that we need to somehow automate the process of putting estimates on the plot. That’s what we do next.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data_lm</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 6
  term  estimate  p.value   LCL   UCL p    
  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1 age      0.645 1.24e-23 0.520 0.770 **** </code></pre>
</div>
<p>Namely, we use our small dataset with only “age” predictor and:</p>
<ul>
<li>First, we use the estimate as a line.</li>
<li>Then, we use the “annotate” function to create a rectangle with Lower and Upper Confidence Limits for y-coordinates and Infinity for x-coordinates.</li>
<li>The opacity, color, and size of our lines would allow us to make our plot more appealing than the {quantreg} plot.</li>
<li>Finally, we’ll put the estimate and the p-value stars as a piece of text on our plot in the location of our choice. We can control the location via “x” and “y” arguments and adjust it horizontally via “hjust” or vertically via “vjust” when we need to. The “paste” command helps us to combine a real text with a number and significance stars into a single piece of information.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># OLS</span></span>
<span><span class='va'>q_plot3</span> <span class='op'>&lt;-</span> <span class='va'>q_plot2</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, </span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.2</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, alpha <span class='op'>=</span> <span class='fl'>.1</span>, fill<span class='op'>=</span><span class='st'>"red"</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>UCL</span>, </span>
<span>           xmin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>,        xmax <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, color<span class='op'>=</span><span class='st'>"red"</span>,</span>
<span>           x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.1</span>,</span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"OLS = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>p</span> <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>q_plot3</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<h2 id="put-three-most-important-quantiles-on-the-plot">5. Put three most important quantiles on the plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data_qr</span></span></code></pre>
</div>
<pre><code># A tibble: 19 × 7
   term  estimate  p.value   tau   LCL   UCL p    
   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 age      0.371 2.09e- 4  0.05 0.175 0.566 ***  
 2 age      0.360 1.82e- 8  0.1  0.235 0.485 **** 
 3 age      0.401 2.16e-12  0.15 0.289 0.512 **** 
 4 age      0.411 1.53e-12  0.2  0.297 0.524 **** 
 5 age      0.472 2.00e-15  0.25 0.356 0.587 **** 
 6 age      0.513 0         0.3  0.398 0.627 **** 
 7 age      0.531 0         0.35 0.418 0.645 **** 
 8 age      0.584 0         0.4  0.472 0.696 **** 
 9 age      0.602 0         0.45 0.488 0.715 **** 
10 age      0.652 0         0.5  0.536 0.767 **** 
11 age      0.705 0         0.55 0.579 0.831 **** 
12 age      0.713 0         0.6  0.583 0.843 **** 
13 age      0.756 0         0.65 0.622 0.890 **** 
14 age      0.850 0         0.7  0.708 0.991 **** 
15 age      0.891 0         0.75 0.728 1.05  **** 
16 age      0.919 0         0.8  0.732 1.10  **** 
17 age      0.974 0         0.85 0.762 1.19  **** 
18 age      1.12  6.20e-13  0.9  0.813 1.42  **** 
19 age      1.89  0         0.95 1.59  2.20  **** </code></pre>
</div>
<p>Similar to the results of linear regression, we can easily put the results of the three most important quantiles on our plot. There are only two small differences:</p>
<ul>
<li>First, we use “geom_pointrange” instead of “geom_line” and “geom_rect”.</li>
<li>Secondly, since our dataset for age now contains 19 different quantiles, we need to specify which line of the estimate or confidence intervals we should use. In our case, we’d use 2 for the first quantile (tau = 0.1), 10 for the median regression (tau = 0.5), and 18 for the ninth quantile (tau = 0.9).</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>  <span class='co'># tau = .1</span></span>
<span><span class='va'>q_plot4</span> <span class='op'>&lt;-</span> <span class='va'>q_plot3</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>, </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.1</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.1</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>, </span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># tau = .5</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>, </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.5</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span>  <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>, </span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># tau = .9</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>, </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.9</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom<span class='op'>=</span><span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.9</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>,</span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='va'>q_plot4</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>Putting more than 3 quantiles on this plot would unnecessarily clutter it. But using the 3 most important ones seems optimal to me. And while estimates are useful, since we don’t need to stair at the axis below, we don’t really need the significance stars. And here’s why: a simple trick to quickly extract inference from this plot is to look whether the confidence intervals cross the grey line. If they do, we usually can’t reject the Null Hypothesis. If they don’t, we can. Interestingly, the trick with confidence intervals works for comparing models too. So, when red and green CIs don’t overlap, the models differ significantly. In this concrete example, that would mean that the classic linear regression, which says that an increase in age of one year would increase the salary by $640 on average, overpromises wage rise for low earners and underpromises for folks who started their career with high salary from the very beginning. Despite the fact that {quantreg} package doesn’t compare the taus among each other, even when different quantile models don’t overlap, I would see them as significantly different.</p>
<p>So, this picture combines the capabilities of {sjPlot} and of {quantreg} packages (halliluja!). But that is just a beginning, because we now can put all the building blocks together and create a function that automates this procedure for any predictor in a multivariable model.</p>
<h1 id="create-a-function-to-automate-plot-creation">Create a function to automate plot creation</h1>
<p>If you’re wondering why I didn’t give you the function at the very beginning, the answer is simple: you might have learned less! Besides, copy-pasting functions, which I have often done, can create problems later because I don’t understand every part of the code well enough. And finally, it wouldn’t fit on the screen :)</p>
<p>To create a function, we simply combine the 5 steps we just coded. We only need to make a few changes to the already existing code, namely:</p>
<ul>
<li><p>The first line, where we name our function and put the arguments we need. We only need three arguments: the first one is the predictor we want to visualize, and the other two are just pieces of text which we would put on the axis.</p></li>
<li><p>Tidying up datasets goes without any change.</p></li>
<li><p>Using the “predictor” argument instead of the name of the concrete predictor “age” will allow us to choose predictors we want to see in the plot.</p></li>
<li><p>Plotting estimates, Intercept, OLS, and Quantiles also goes without any change.</p></li>
<li><p>and finally, those two arguments of our function, “intercept” and “estimates”, allow us to automate labeling. And that’s it!</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cool_QR_plot</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>predictor</span>, <span class='va'>intercept</span>, <span class='va'>estimates</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span><span class='co'># tidy up results</span></span>
<span><span class='va'>lr_preds</span> <span class='op'>&lt;-</span> <span class='va'>lr</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>se.type <span class='op'>=</span> <span class='st'>"nid"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'># se.type = "rank"</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>LCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>-</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span>, </span>
<span>         UCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>+</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>!=</span> <span class='st'>"(Intercept)"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://rpkgs.datanovia.com/rstatix/reference/add_significance.html'>add_significance</a></span><span class='op'>(</span><span class='st'>"p.value"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>std.error</span>, <span class='op'>-</span><span class='va'>statistic</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p.value.signif</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qr_preds</span> <span class='op'>&lt;-</span> <span class='va'>qr_all</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>se.type <span class='op'>=</span> <span class='st'>"nid"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>LCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>-</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span>, </span>
<span>         UCL <span class='op'>=</span> <span class='va'>estimate</span> <span class='op'>+</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='va'>std.error</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"Intercept"</span>, <span class='va'>term</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://rpkgs.datanovia.com/rstatix/reference/add_significance.html'>add_significance</a></span><span class='op'>(</span><span class='st'>"p.value"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>std.error</span>, <span class='op'>-</span><span class='va'>statistic</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p.value.signif</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='co'># isolate one predictor</span></span>
<span><span class='va'>data_lm</span> <span class='op'>=</span> <span class='va'>lr_preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>==</span> <span class='va'>predictor</span><span class='op'>)</span></span>
<span><span class='va'>data_qr</span> <span class='op'>=</span> <span class='va'>qr_preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>term</span> <span class='op'>==</span> <span class='va'>predictor</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># plot them</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data_qr</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tau</span>, y <span class='op'>=</span> <span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>  <span class='co'># color #27408b</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span> color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>UCL</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.25</span>, fill <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_reverse</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Intercept</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, alpha <span class='op'>=</span> <span class='fl'>.3</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># OLS</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, alpha <span class='op'>=</span> <span class='fl'>.2</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, alpha <span class='op'>=</span> <span class='fl'>.1</span>, fill<span class='op'>=</span><span class='st'>"red"</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>UCL</span>, </span>
<span>           xmin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>,        xmax <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, color <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>           x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.1</span>,</span>
<span>          label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"OLS = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_lm</span><span class='op'>$</span><span class='va'>estimate</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_lm</span><span class='op'>$</span><span class='va'>p</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># tau = .1</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>,  </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.1</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.1</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>, </span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># tau = .5</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>,  </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.5</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span>  <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>, </span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># tau = .9</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"pointrange"</span>, </span>
<span>           x    <span class='op'>=</span> <span class='fl'>.9</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>           y    <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>LCL</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, </span>
<span>           ymax <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>UCL</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom<span class='op'>=</span><span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='fl'>.9</span> <span class='op'>-</span> <span class='fl'>0.05</span>, </span>
<span>           y <span class='op'>=</span> <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.14</span>,</span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>data_qr</span><span class='op'>$</span><span class='va'>estimate</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>data_qr</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>18</span><span class='op'>]</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='st'>"Wage change:"</span>, <span class='va'>intercept</span>, <span class='st'>"(gray) and"</span>, <span class='va'>estimates</span>, <span class='st'>"(colored)"</span><span class='op'>)</span>,</span>
<span>       x <span class='op'>=</span> <span class='st'>"Quantile (tau)"</span><span class='op'>)</span></span>
<span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h2 id="use-this-function">Use this function</h2>
<p>Now that we have this function, we’re able to produce these plots for all our numerical predictors or for each category of our categorical predictor.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"age"</span>, <span class='st'>"age = 0"</span>, <span class='st'>"increasing age"</span><span class='op'>)</span></span></code></pre>
</div>
<img src="qr2_files/figure-html5/unnamed-chunk-18-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"jobclass2. Information"</span>, <span class='st'>"jobclass = Industrial"</span>, <span class='st'>"IT"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-18-2.png" width="624" /></p>
</div>
<p>To demonstrate how efficiently we can generate comprehensive multi-plots from complex multivariable models, consider this example. We’ll first enhance our models by incorporating the “education” predictor with its five distinct categories.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lr</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>education</span>, <span class='va'>Wage</span><span class='op'>)</span></span>
<span><span class='va'>qr10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>education</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span></span>
<span><span class='va'>qr50</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>education</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='va'>qr90</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>education</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qr_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>education</span>, <span class='va'>Wage</span>, </span>
<span>             tau  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.05</span>, <span class='fl'>.95</span>, by <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next, we produce separate plots for each numerical predictor and each category of our categorical predictors and save them into separate objects.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>job</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"jobclass2. Information"</span>, <span class='st'>"jobclass = Industrial"</span>, <span class='st'>"IT"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>age</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"age"</span>, <span class='st'>"age = 0"</span>, <span class='st'>"increasing age"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>edu_hs</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"education2. HS Grad"</span>, <span class='st'>"Educ. = &lt; HS Grad"</span>, <span class='st'>"HS"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>edu_sc</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"education3. Some College"</span>, <span class='st'>"Educ. = &lt; HS"</span>, <span class='st'>"≈ College"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>edu_coll</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"education4. College Grad"</span>, <span class='st'>"Educ. = &lt; HS"</span>, <span class='st'>"College"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>edu_high</span> <span class='op'>&lt;-</span> <span class='fu'>cool_QR_plot</span><span class='op'>(</span><span class='st'>"education5. Advanced Degree"</span>, <span class='st'>"Educ. = &lt; HS"</span>, <span class='st'>"Uni | PhD"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>And finally, we put together all the individual plots into a comprehensive multiplot using the {patchwork} package. I will not go into the code here, since I just published a video on using the {patchwork} package. Instead, I’d like to highlight the “job” plot, which now presents a completely different perspective compared to the original one.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span> <span class='co'># extra video on my channel</span></span>
<span></span>
<span><span class='va'>job</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>edu_hs</span> <span class='op'>+</span> <span class='va'>edu_sc</span> <span class='op'>+</span> <span class='va'>edu_coll</span> <span class='op'>+</span> <span class='va'>edu_high</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>3</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span></span>
<span>    title    <span class='op'>=</span> <span class='st'>"Salaries predicted by profession, age and education"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Should you invest in yourself?"</span>,</span>
<span>    caption  <span class='op'>=</span> <span class='st'>"Data source: ISLR package"</span>,</span>
<span>    tag_levels <span class='op'>=</span> <span class='st'>"A"</span>,  <span class='co'># 'a', '1', ⁠'i⁠, or 'I'</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-21-1.png" width="1344" /></p>
</div>
<h2 id="effect-size-of-all-concfounders">Effect size of all concfounders</h2>
<p>The impact of the “job” predictor on the response variable changed significantly because we introduced a much stronger predictor for “wage” – “education”. The {effectsize} package and the “eta_squared” function demonstrate that the effect of “education” is 4 times stronger than the effect of “jobclass”. Thus, education matters. (Like, whaaattt???) This phenomenon often arises due to a confounding factor, a topic that deserves a separate discussion. On that note, I’d be curious to know how many of you guys are familiar with the concept of confounding. Please share your thoughts in the comments section below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://easystats.github.io/effectsize/'>effectsize</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://easystats.github.io/effectsize/reference/eta_squared.html'>eta_squared</a></span><span class='op'>(</span><span class='va'>lr</span>, alternative <span class='op'>=</span> <span class='st'>"two.sided"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Eta2 (partial) |       95% CI
-----------------------------------------
jobclass  |           0.05 | [0.04, 0.07]
age       |           0.04 | [0.03, 0.06]
education |           0.20 | [0.18, 0.23]</code></pre>
</div>
<p>Now, when we look at our fancy multiplot, we’ll see four distinct subplots dedicated to the “education” predictor, each comparing a unique education category to the reference level, namely “no high school education”. While comparing solely to the reference level may sufficient in some cases, I personally prefer to conduct pairwise comparisons between all categories to extract the maximum amount of information from the model. This can be easily done with one of my absolute favorite R packages, the {emmeans} package.</p>
<h1 id="unleash-the-power-of-contrasts-with-emmeans">Unleash the power of contrasts with {emmeans}</h1>
<h2 id="get-table-of-predictions-for-every-tau">Get table of predictions for every tau</h2>
<p>What the {emmeans} package does is that it enables us to compare education categories pairwisely for <strong>every tau</strong> in the quantile regression. However, since seeing so many results can be overwhelming, we can restrict the taus to only the most important ones through the user-friendly “tau” argument. If you prefer to have the 95% confidence intervals instead of standard errors, you can add the “infer = T” argument to the “emmeans” function.</p>
<div class="layout-chunk" data-layout="l-screen-inset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rvlenth/emmeans'>emmeans</a></span><span class='op'>)</span> <span class='co'># extra video on my channel ... it's really useful!</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr_all</span>, </span>
<span>        <span class='va'>pairwise</span> <span class='op'>~</span> <span class='va'>education</span>, </span>
<span>        by  <span class='op'>=</span> <span class='st'>"tau"</span>, </span>
<span>        tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.9</span><span class='op'>)</span>,</span>
<span>        weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='co'># infer = T</span></span></code></pre>
</div>
<pre><code>$emmeans
tau = 0.1:
 education          emmean    SE   df lower.CL upper.CL
 1. &lt; HS Grad         61.6  2.15 2993     57.4     65.8
 2. HS Grad           67.7  1.03 2993     65.7     69.7
 3. Some College      77.0  2.26 2993     72.6     81.5
 4. College Grad      80.9  2.10 2993     76.8     85.1
 5. Advanced Degree   96.1  3.35 2993     89.6    102.7

tau = 0.9:
 education          emmean    SE   df lower.CL upper.CL
 1. &lt; HS Grad        114.4  2.02 2993    110.5    118.4
 2. HS Grad          128.2  1.52 2993    125.2    131.2
 3. Some College     141.1  1.85 2993    137.4    144.7
 4. College Grad     168.7  3.30 2993    162.2    175.2
 5. Advanced Degree  255.7 20.43 2993    215.7    295.8

Results are averaged over the levels of: jobclass 
Confidence level used: 0.95 

$contrasts
tau = 0.1:
 contrast                             estimate    SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad               -6.08  2.36 2993  -2.574
 1. &lt; HS Grad - 3. Some College         -15.39  3.11 2993  -4.950
 1. &lt; HS Grad - 4. College Grad         -19.30  3.02 2993  -6.386
 1. &lt; HS Grad - 5. Advanced Degree      -34.50  4.01 2993  -8.598
 2. HS Grad - 3. Some College            -9.31  2.47 2993  -3.766
 2. HS Grad - 4. College Grad           -13.22  2.35 2993  -5.625
 2. HS Grad - 5. Advanced Degree        -28.42  3.53 2993  -8.060
 3. Some College - 4. College Grad       -3.90  3.07 2993  -1.271
 3. Some College - 5. Advanced Degree   -19.10  4.03 2993  -4.736
 4. College Grad - 5. Advanced Degree   -15.20  3.92 2993  -3.879
 p.value
  0.0754
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0016
  &lt;.0001
  &lt;.0001
  0.7091
  &lt;.0001
  0.0010

tau = 0.9:
 contrast                             estimate    SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad              -13.74  2.09 2993  -6.590
 1. &lt; HS Grad - 3. Some College         -26.61  2.48 2993 -10.710
 1. &lt; HS Grad - 4. College Grad         -54.25  3.75 2993 -14.454
 1. &lt; HS Grad - 5. Advanced Degree     -141.29 20.51 2993  -6.888
 2. HS Grad - 3. Some College           -12.87  2.23 2993  -5.783
 2. HS Grad - 4. College Grad           -40.51  3.55 2993 -11.394
 2. HS Grad - 5. Advanced Degree       -127.54 20.47 2993  -6.230
 3. Some College - 4. College Grad      -27.64  3.73 2993  -7.418
 3. Some College - 5. Advanced Degree  -114.67 20.50 2993  -5.594
 4. College Grad - 5. Advanced Degree   -87.04 20.68 2993  -4.208
 p.value
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0003

Results are averaged over the levels of: jobclass 
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
<p>The output of the “emmeans” function consists of two tables. The upper table provides predicted values for every group of the categorical predictor and for every tau. The second table provides contrasts or differences between groups for every tau. To make these tables even more useful, let’s first visualize the predicted values and then produce the best table of contrasts.</p>
<h2 id="plot-predictions-of-every-tau">Plot predictions of every tau</h2>
<p>Visualizing <strong>predictions for each quantile</strong> is remarkably straightforward with the {emmeans} package and the “emmip” function. All we need are 1) the fitted model, 2) the predictor of interest, 3) the inclusion of confidence intervals (via “CIs = TRUE”), and 4) the specification of the quantiles we aim to plot. In practice, plotting all quantiles is often unnecessary and will just clutter our visualization. That’s why I often go for a maximum of 3 quantiles. For numeric variables, we must also provide a list of values for which we want to see predictions; otherwise, the “emmip” function will only plot the predictions for the average “age” for each quantile.</p>
<div class="layout-chunk" data-layout="l-screen">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmip.html'>emmip</a></span><span class='op'>(</span><span class='va'>qr_all</span>, <span class='va'>tau</span> <span class='op'>~</span> <span class='va'>education</span>, CIs <span class='op'>=</span> <span class='cn'>T</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.5</span>, <span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmip.html'>emmip</a></span><span class='op'>(</span><span class='va'>qr_all</span>, <span class='va'>tau</span> <span class='op'>~</span> <span class='va'>age</span>, CIs <span class='op'>=</span> <span class='cn'>T</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.5</span>, <span class='fl'>.9</span><span class='op'>)</span>,</span>
<span>      at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>45</span>, <span class='fl'>65</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmip.html'>emmip</a></span><span class='op'>(</span><span class='va'>qr_all</span>, <span class='va'>tau</span> <span class='op'>~</span> <span class='va'>age</span>, CIs <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-24-1.png" width="1824" /></p>
</div>
<p>The three taus are more than enough to tell a compelling story. Namely, common people without education earn similarly to the lowest 10% earners with a college degree, but still less than the lowest 10% of earners with the highest education. But even without education, you can be successful and earn more than some highly educated folks in the lowest quantile. However, education opens more doors to growth in salary, as can be seen by the difference between the lowest and highest quantiles. The difference between the lowest and highest salaries without education is much smaller than the difference between the lowest and highest salaries with the highest education. The classic linear regression would never have been able to deliver so much inference, so that quantile regression simply rocks! And if you also find it as useful as me, consider hitting the like button.</p>
<h2 id="interactions-also-work-not-part-of-the-video-since-too-much">Interactions also work (not part of the video, since too much)</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>qr_all_int</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/quantreg/man/rq.html'>rq</a></span><span class='op'>(</span><span class='va'>wage</span> <span class='op'>~</span> <span class='va'>jobclass</span><span class='op'>*</span><span class='va'>education</span>, <span class='va'>Wage</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.25</span>, <span class='fl'>.75</span>, by <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr_all_int</span>, <span class='va'>pairwise</span> <span class='op'>~</span> <span class='va'>education</span> <span class='op'>|</span> <span class='va'>jobclass</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, by <span class='op'>=</span> <span class='st'>"tau"</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.25</span>, <span class='fl'>.75</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#  infer = T for 95% CIs</span></span></code></pre>
</div>
<pre><code>$emmeans
jobclass = 1. Industrial, tau = 0.25:
 education          emmean   SE   df lower.CL upper.CL
 1. &lt; HS Grad         69.1 1.54 2990     66.1     72.1
 2. HS Grad           76.9 1.37 2990     74.2     79.6
 3. Some College      88.0 1.83 2990     84.4     91.6
 4. College Grad      94.1 3.28 2990     87.6    100.5
 5. Advanced Degree  104.9 6.79 2990     91.6    118.2

jobclass = 2. Information, tau = 0.25:
 education          emmean   SE   df lower.CL upper.CL
 1. &lt; HS Grad         72.2 2.98 2990     66.3     78.0
 2. HS Grad           79.9 1.50 2990     76.9     82.8
 3. Some College      90.5 1.61 2990     87.3     93.6
 4. College Grad      99.7 1.45 2990     96.9    102.5
 5. Advanced Degree  118.9 1.99 2990    115.0    122.8

jobclass = 1. Industrial, tau = 0.75:
 education          emmean   SE   df lower.CL upper.CL
 1. &lt; HS Grad         93.1 3.43 2990     86.3     99.8
 2. HS Grad          109.8 1.76 2990    106.4    113.3
 3. Some College     120.6 2.46 2990    115.8    125.4
 4. College Grad     138.3 2.74 2990    132.9    143.7
 5. Advanced Degree  158.3 5.38 2990    147.7    168.8

jobclass = 2. Information, tau = 0.75:
 education          emmean   SE   df lower.CL upper.CL
 1. &lt; HS Grad        101.8 5.83 2990     90.4    113.3
 2. HS Grad          111.7 1.18 2990    109.4    114.0
 3. Some College     121.4 1.97 2990    117.6    125.3
 4. College Grad     145.8 1.52 2990    142.8    148.8
 5. Advanced Degree  177.0 5.05 2990    167.1    186.9

Confidence level used: 0.95 

$contrasts
jobclass = 1. Industrial, tau = 0.25:
 contrast                             estimate   SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad               -7.80 2.06 2990  -3.776
 1. &lt; HS Grad - 3. Some College         -18.88 2.39 2990  -7.899
 1. &lt; HS Grad - 4. College Grad         -24.97 3.63 2990  -6.885
 1. &lt; HS Grad - 5. Advanced Degree      -35.82 6.97 2990  -5.142
 2. HS Grad - 3. Some College           -11.09 2.28 2990  -4.857
 2. HS Grad - 4. College Grad           -17.18 3.56 2990  -4.829
 2. HS Grad - 5. Advanced Degree        -28.03 6.93 2990  -4.044
 3. Some College - 4. College Grad       -6.09 3.76 2990  -1.622
 3. Some College - 5. Advanced Degree   -16.94 7.03 2990  -2.408
 4. College Grad - 5. Advanced Degree   -10.85 7.55 2990  -1.438
 p.value
  0.0015
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0005
  0.4833
  0.1134
  0.6032

jobclass = 2. Information, tau = 0.25:
 contrast                             estimate   SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad               -7.70 3.33 2990  -2.311
 1. &lt; HS Grad - 3. Some College         -18.33 3.38 2990  -5.417
 1. &lt; HS Grad - 4. College Grad         -27.54 3.31 2990  -8.322
 1. &lt; HS Grad - 5. Advanced Degree      -46.73 3.58 2990 -13.056
 2. HS Grad - 3. Some College           -10.63 2.20 2990  -4.824
 2. HS Grad - 4. College Grad           -19.83 2.09 2990  -9.507
 2. HS Grad - 5. Advanced Degree        -39.03 2.49 2990 -15.656
 3. Some College - 4. College Grad       -9.21 2.17 2990  -4.252
 3. Some College - 5. Advanced Degree   -28.40 2.56 2990 -11.098
 4. College Grad - 5. Advanced Degree   -19.19 2.46 2990  -7.804
 p.value
  0.1416
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0002
  &lt;.0001
  &lt;.0001

jobclass = 1. Industrial, tau = 0.75:
 contrast                             estimate   SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad              -16.78 3.86 2990  -4.351
 1. &lt; HS Grad - 3. Some College         -27.54 4.22 2990  -6.522
 1. &lt; HS Grad - 4. College Grad         -45.25 4.39 2990 -10.301
 1. &lt; HS Grad - 5. Advanced Degree      -65.24 6.38 2990 -10.222
 2. HS Grad - 3. Some College           -10.76 3.02 2990  -3.559
 2. HS Grad - 4. College Grad           -28.47 3.26 2990  -8.744
 2. HS Grad - 5. Advanced Degree        -48.46 5.66 2990  -8.561
 3. Some College - 4. College Grad      -17.71 3.68 2990  -4.811
 3. Some College - 5. Advanced Degree   -37.71 5.92 2990  -6.374
 4. College Grad - 5. Advanced Degree   -20.00 6.04 2990  -3.311
 p.value
  0.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0035
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0083

jobclass = 2. Information, tau = 0.75:
 contrast                             estimate   SE   df t.ratio
 1. &lt; HS Grad - 2. HS Grad               -9.90 5.95 2990  -1.664
 1. &lt; HS Grad - 3. Some College         -19.61 6.15 2990  -3.187
 1. &lt; HS Grad - 4. College Grad         -43.98 6.02 2990  -7.301
 1. &lt; HS Grad - 5. Advanced Degree      -75.17 7.71 2990  -9.745
 2. HS Grad - 3. Some College            -9.71 2.29 2990  -4.236
 2. HS Grad - 4. College Grad           -34.08 1.92 2990 -17.735
 2. HS Grad - 5. Advanced Degree        -65.27 5.19 2990 -12.584
 3. Some College - 4. College Grad      -24.37 2.49 2990  -9.806
 3. Some College - 5. Advanced Degree   -55.56 5.42 2990 -10.249
 4. College Grad - 5. Advanced Degree   -31.18 5.27 2990  -5.912
 p.value
  0.4564
  0.0126
  &lt;.0001
  &lt;.0001
  0.0002
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001
  &lt;.0001

P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmip.html'>emmip</a></span><span class='op'>(</span><span class='va'>qr_all_int</span>, <span class='va'>tau</span> <span class='op'>~</span> <span class='va'>education</span> <span class='op'>|</span> <span class='va'>jobclass</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, CIs <span class='op'>=</span> <span class='cn'>T</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.25</span>, <span class='fl'>.75</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<h2 id="prepare-predictions-of-all-models-to-add-ols-results">Prepare predictions of all models to add OLS results</h2>
<p>Speaking of classic linear regression. The only downside to these predictions is that they don’t include the comparison to linear regression. But we can easily fix this by again using the “emmeans” package to extract predictions from each model for each predictor and each “tau” separately, and then combine them into a new data frame called, let’s say, “preds”.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>preds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>    </span>
<span>    <span class='co'># OLS</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>lr</span>, <span class='op'>~</span> <span class='va'>education</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"education"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>education</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>lr</span>, <span class='op'>~</span> <span class='va'>jobclass</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"jobclass"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>jobclass</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>lr</span>, <span class='op'>~</span> <span class='va'>age</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"age"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>age</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>strata</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='st'>"OLS"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>    </span>
<span>    <span class='co'># QR = 10%</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr10</span>, <span class='op'>~</span> <span class='va'>education</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"education"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>education</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr10</span>, <span class='op'>~</span> <span class='va'>jobclass</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"jobclass"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>jobclass</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr10</span>, <span class='op'>~</span> <span class='va'>age</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"age"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>age</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>strata</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='st'>"QR 10%"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>    </span>
<span>    <span class='co'># QR = 50%</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr50</span>, <span class='op'>~</span> <span class='va'>education</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"education"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>education</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr50</span>, <span class='op'>~</span> <span class='va'>jobclass</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"jobclass"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>jobclass</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr50</span>, <span class='op'>~</span> <span class='va'>age</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"age"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>age</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>strata</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='st'>"QR 50%"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>    </span>
<span>    <span class='co'># QR = 90%</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr90</span>, <span class='op'>~</span> <span class='va'>education</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"education"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>education</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr90</span>, <span class='op'>~</span> <span class='va'>jobclass</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"jobclass"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>jobclass</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='va'>qr90</span>, <span class='op'>~</span> <span class='va'>age</span>, weights <span class='op'>=</span> <span class='st'>"prop"</span>, at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>predictor <span class='op'>=</span> <span class='st'>"age"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='va'>age</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>strata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>strata</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='st'>"QR 90%"</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>SE</span>, <span class='op'>-</span><span class='va'>df</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>`Predicted wage` <span class='op'>=</span> <span class='va'>emmean</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="plot-predictions-of-all-models-ols-qr">Plot predictions of all models OLS &amp; QR</h2>
<p>We can then use a classic “ggplot” function with “geom_errorbar” and “geom_point” to:</p>
<ul>
<li><p>first, create individual plots containing all 4 models for each predictor,</p></li>
<li><p>then, combine these plots into a single figure using {patchwork},</p></li>
<li><p>and finally, save this multi-plot for publication in a format, quality, and size of our choice.</p></li>
</ul>
<p>Cool, right?</p>
<div class="layout-chunk" data-layout="l-screen">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>predictor</span> <span class='op'>==</span> <span class='st'>"education"</span><span class='op'>)</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>strata</span>, y <span class='op'>=</span> <span class='va'>`Predicted wage`</span>, color <span class='op'>=</span> <span class='va'>model</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>lower.CL</span>, ymax <span class='op'>=</span> <span class='va'>upper.CL</span><span class='op'>)</span>, </span>
<span>  position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>1</span>, shape<span class='op'>=</span><span class='fl'>21</span>, fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Education"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>predictor</span> <span class='op'>==</span> <span class='st'>"jobclass"</span><span class='op'>)</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>strata</span>, y <span class='op'>=</span> <span class='va'>`Predicted wage`</span>, color <span class='op'>=</span> <span class='va'>model</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>lower.CL</span>, ymax <span class='op'>=</span> <span class='va'>upper.CL</span><span class='op'>)</span>, </span>
<span>  position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.3</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.3</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>1</span>, shape<span class='op'>=</span><span class='fl'>21</span>, fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Job Type"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>preds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>predictor</span> <span class='op'>==</span> <span class='st'>"age"</span><span class='op'>)</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>strata</span>, y <span class='op'>=</span> <span class='va'>`Predicted wage`</span>, color <span class='op'>=</span> <span class='va'>model</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>lower.CL</span>, ymax <span class='op'>=</span> <span class='va'>upper.CL</span><span class='op'>)</span>, </span>
<span>  position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>1</span>, shape<span class='op'>=</span><span class='fl'>21</span>, fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Age"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span> <span class='op'>+</span> <span class='va'>c</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>tag_levels <span class='op'>=</span> <span class='st'>"A"</span><span class='op'>)</span></span></code></pre>
</div>
<img src="qr2_files/figure-html5/unnamed-chunk-27-1.png" width="1824" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"preds_all_models.png"</span>,</span>
<span>  device <span class='op'>=</span> <span class='va'>png</span>,</span>
<span>  plot <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/last_plot.html'>last_plot</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>  dpi <span class='op'>=</span> <span class='fl'>999</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>16</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>5</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="get-fancy-table-for-your-publication">Get fancy table for your publication</h2>
<p>But despite all the coolness of prediction plots, we sometimes need tables with pairwise comparisons to provide p-values. Putting p-values on plots would clutter them, so tables are sometimes a better option. And the best way to get such tables in my opinion is to use the “tbl_regression” function from the {gtsummary} package. Using just a few simple arguments inside the “tbl_regression” function will produce a perfect table for any model. For example, we can create four tables, one for the classic linear regression and three for the quantile regressions. Then, we can easily put them side by side using the “tbl_merge” function and save them in either Microsoft Word or PNG format for our publication. Isn’t that amazing?”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ddsjoberg/gtsummary'>gtsummary</a></span><span class='op'>)</span> <span class='co'># extra video on my channel</span></span>
<span></span>
<span><span class='va'>qr90_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html'>tbl_regression</a></span><span class='op'>(</span></span>
<span>        <span class='va'>qr90</span>, </span>
<span>        add_pairwise_contrasts <span class='op'>=</span> <span class='cn'>T</span>,</span>
<span>        emmeans_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tau <span class='op'>=</span> <span class='fl'>.90</span><span class='op'>)</span>,</span>
<span>        pvalue_fun   <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_pvalue.html'>style_pvalue</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,</span>
<span>        estimate_fun <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_number.html'>style_number</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>        <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qr90_table</span></span></code></pre>
</div>
<div id="czomdqbfpc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#czomdqbfpc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#czomdqbfpc thead, #czomdqbfpc tbody, #czomdqbfpc tfoot, #czomdqbfpc tr, #czomdqbfpc td, #czomdqbfpc th {
  border-style: none;
}

#czomdqbfpc p {
  margin: 0;
  padding: 0;
}

#czomdqbfpc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#czomdqbfpc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#czomdqbfpc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#czomdqbfpc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#czomdqbfpc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czomdqbfpc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czomdqbfpc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czomdqbfpc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#czomdqbfpc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#czomdqbfpc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#czomdqbfpc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#czomdqbfpc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#czomdqbfpc .gt_spanner_row {
  border-bottom-style: hidden;
}

#czomdqbfpc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#czomdqbfpc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#czomdqbfpc .gt_from_md > :first-child {
  margin-top: 0;
}

#czomdqbfpc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#czomdqbfpc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#czomdqbfpc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#czomdqbfpc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#czomdqbfpc .gt_row_group_first td {
  border-top-width: 2px;
}

#czomdqbfpc .gt_row_group_first th {
  border-top-width: 2px;
}

#czomdqbfpc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czomdqbfpc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#czomdqbfpc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#czomdqbfpc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czomdqbfpc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czomdqbfpc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#czomdqbfpc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#czomdqbfpc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#czomdqbfpc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czomdqbfpc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czomdqbfpc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czomdqbfpc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czomdqbfpc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czomdqbfpc .gt_left {
  text-align: left;
}

#czomdqbfpc .gt_center {
  text-align: center;
}

#czomdqbfpc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#czomdqbfpc .gt_font_normal {
  font-weight: normal;
}

#czomdqbfpc .gt_font_bold {
  font-weight: bold;
}

#czomdqbfpc .gt_font_italic {
  font-style: italic;
}

#czomdqbfpc .gt_super {
  font-size: 65%;
}

#czomdqbfpc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#czomdqbfpc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#czomdqbfpc .gt_indent_1 {
  text-indent: 5px;
}

#czomdqbfpc .gt_indent_2 {
  text-indent: 10px;
}

#czomdqbfpc .gt_indent_3 {
  text-indent: 15px;
}

#czomdqbfpc .gt_indent_4 {
  text-indent: 20px;
}

#czomdqbfpc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Beta&lt;/strong&gt;"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">jobclass</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="ci" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    2. Information - 1. Industrial</td>
<td headers="estimate" class="gt_row gt_center">3.00</td>
<td headers="ci" class="gt_row gt_center">-0.72, 6.72</td>
<td headers="p.value" class="gt_row gt_center">0.114</td></tr>
    <tr><td headers="label" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_center">0.81</td>
<td headers="ci" class="gt_row gt_center">0.67, 0.95</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">education</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="ci" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    2. HS Grad - 1. &lt; HS Grad</td>
<td headers="estimate" class="gt_row gt_center">13.74</td>
<td headers="ci" class="gt_row gt_center">8.05, 19.43</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    3. Some College - 1. &lt; HS Grad</td>
<td headers="estimate" class="gt_row gt_center">26.61</td>
<td headers="ci" class="gt_row gt_center">19.83, 33.40</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    3. Some College - 2. HS Grad</td>
<td headers="estimate" class="gt_row gt_center">12.87</td>
<td headers="ci" class="gt_row gt_center">6.80, 18.95</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    4. College Grad - 1. &lt; HS Grad</td>
<td headers="estimate" class="gt_row gt_center">54.25</td>
<td headers="ci" class="gt_row gt_center">44.00, 64.49</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    4. College Grad - 2. HS Grad</td>
<td headers="estimate" class="gt_row gt_center">40.51</td>
<td headers="ci" class="gt_row gt_center">30.80, 50.21</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    4. College Grad - 3. Some College</td>
<td headers="estimate" class="gt_row gt_center">27.64</td>
<td headers="ci" class="gt_row gt_center">17.47, 37.80</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    5. Advanced Degree - 1. &lt; HS Grad</td>
<td headers="estimate" class="gt_row gt_center">141.29</td>
<td headers="ci" class="gt_row gt_center">85.30, 197.27</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    5. Advanced Degree - 2. HS Grad</td>
<td headers="estimate" class="gt_row gt_center">127.54</td>
<td headers="ci" class="gt_row gt_center">71.66, 183.42</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    5. Advanced Degree - 3. Some College</td>
<td headers="estimate" class="gt_row gt_center">114.67</td>
<td headers="ci" class="gt_row gt_center">58.72, 170.63</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    5. Advanced Degree - 4. College Grad</td>
<td headers="estimate" class="gt_row gt_center">87.04</td>
<td headers="ci" class="gt_row gt_center">30.59, 143.49</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;"><0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>qr50_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html'>tbl_regression</a></span><span class='op'>(</span></span>
<span>        <span class='va'>qr50</span>, </span>
<span>        add_pairwise_contrasts <span class='op'>=</span> <span class='cn'>T</span>,</span>
<span>        emmeans_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tau <span class='op'>=</span> <span class='fl'>.50</span><span class='op'>)</span>,</span>
<span>        pvalue_fun   <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_pvalue.html'>style_pvalue</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,</span>
<span>        estimate_fun <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_number.html'>style_number</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>        <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qr10_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html'>tbl_regression</a></span><span class='op'>(</span></span>
<span>        <span class='va'>qr10</span>, </span>
<span>        add_pairwise_contrasts <span class='op'>=</span> <span class='cn'>T</span>,</span>
<span>        emmeans_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tau <span class='op'>=</span> <span class='fl'>.10</span><span class='op'>)</span>,</span>
<span>        pvalue_fun   <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_pvalue.html'>style_pvalue</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,</span>
<span>        estimate_fun <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_number.html'>style_number</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>        <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lr_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html'>tbl_regression</a></span><span class='op'>(</span></span>
<span>        <span class='va'>lr</span>, </span>
<span>        add_pairwise_contrasts <span class='op'>=</span> <span class='cn'>T</span>,</span>
<span>        pvalue_fun   <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_pvalue.html'>style_pvalue</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,</span>
<span>        estimate_fun <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/style_number.html'>style_number</a></span><span class='op'>(</span><span class='va'>.x</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>        <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/bold_p.html'>bold_p</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fancy_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/tbl_merge.html'>tbl_merge</a></span><span class='op'>(</span></span>
<span>    tbls <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>      <span class='va'>lr_table</span>, <span class='va'>qr10_table</span>, <span class='va'>qr50_table</span>, <span class='va'>qr90_table</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    tab_spanner <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"OLS"</span>, <span class='st'>"QR 10%"</span>, <span class='st'>"QR 50%"</span>, <span class='st'>"QR 90%"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/theme_gtsummary.html'>theme_gtsummary_compact</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ardata-fr.github.io/flextable-book/'>flextable</a></span><span class='op'>)</span></span>
<span><span class='va'>fancy_table</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/as_flex_table.html'>as_flex_table</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/save_as_docx.html'>save_as_docx</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"fancy_table.docx"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/set_gtsummary_theme.html'>reset_gtsummary_theme</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fancy_table</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://www.danieldsjoberg.com/gtsummary/reference/as_flex_table.html'>as_flex_table</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/save_as_image.html'>save_as_image</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"fancy_table.png"</span>, res <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;fancy_table.png&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-screen">
<p><img src="fancy_table.png" width="6956" /></p>
</div>
<h1 id="whats-nest">What’s nest</h1>
<p>Additionally, you can also utilize those {gtsummary} tables directly in your writing, where you can report any result inside of the body of text. This works for both, numeric predictors, like our “age” 0.81 (95% CI 0.67, 0.95; p&lt;0.001) and categorical variables, for example the first education contrast of the highest quantile 13.74 (95% CI 8.05, 19.43; p&lt;0.001). This approach saves you from typos and ensures consistent reporting. And there are actually so many cool things the {gtsummary} package can do, that I dedicated an <a href="https://youtu.be/hyP3Hx_1kTM">entire video to it</a>, so, feel free to check it out if you’re interested.</p>
<ul>
<li>Input:</li>
</ul>
<p>“r inline_text(qr90_table, variable = education, level =”2. HS Grad - 1. &lt; HS Grad”)”</p>
<ul>
<li>Output:</li>
</ul>
<p>13.74 (95% CI 8.05, 19.43; p&lt;0.001)</p>
<h1 id="visualizing-contrasts-it-might-be-an-overkill-so-its-not-part-of-the-video-but-why-not">Visualizing contrasts (it might be an overkill, so, it’s not part of the video, but why not?)</h1>
<p>And since adding pairwise contrasts provides a huge benefit, we can quickly visualize those contrasts with {emmeans} package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/ref_grid.html'>ref_grid</a></span><span class='op'>(</span><span class='va'>qr_all</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>education</span><span class='op'>|</span><span class='va'>tau</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span>weights<span class='op'>=</span><span class='st'>"prop"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmip.html'>emmip</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>tau</span><span class='op'>|</span><span class='va'>contrast</span>, CIs <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Quantile (tau)"</span>, y <span class='op'>=</span> <span class='st'>"Education difference"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-32-1.png" width="1344" /></p>
</div>
<p>Re-scaling all the facets of the plot and not using annotations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/ref_grid.html'>ref_grid</a></span><span class='op'>(</span><span class='va'>qr_all</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>education</span><span class='op'>|</span><span class='va'>tau</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span>weights<span class='op'>=</span><span class='st'>"prop"</span>, infer <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>T</span>,<span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://rdatatable.gitlab.io/data.table/reference/as.data.table.html'>as.data.table</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>rstatix</span><span class='fu'>::</span><span class='fu'><a href='https://rpkgs.datanovia.com/rstatix/reference/add_significance.html'>add_significance</a></span><span class='op'>(</span><span class='st'>"p.value"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>p.value.signif</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>SE</span>, <span class='op'>-</span><span class='va'>df</span>, <span class='op'>-</span><span class='va'>t.ratio</span>, <span class='op'>-</span><span class='va'>p.value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>LCL <span class='op'>=</span> <span class='va'>lower.CL</span>, UCL <span class='op'>=</span> <span class='va'>upper.CL</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># without annotations</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_contrasts</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tau</span>, y <span class='op'>=</span> <span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>  <span class='co'># color #27408b</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span> color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>contrast</span>, scales <span class='op'>=</span> <span class='st'>"free"</span><span class='op'>)</span><span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>UCL</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.25</span>, fill <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_reverse</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span></span>
<span>  <span class='co'># Intercept</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, alpha <span class='op'>=</span> <span class='fl'>.3</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-33-1.png" width="1344" /></p>
</div>
<p>Plotting separate contrasts with annotations by without facets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># with annotations by without facets</span></span>
<span><span class='va'>contrats_1</span> <span class='op'>&lt;-</span> <span class='va'>plot_contrasts</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>contrast</span> <span class='op'>==</span> <span class='st'>"1. &lt; HS Grad - 2. HS Grad"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>contrats_1</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tau</span>, y <span class='op'>=</span> <span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>  <span class='co'># color #27408b</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span> color <span class='op'>=</span> <span class='st'>"green"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>UCL</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.25</span>, fill <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_reverse</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span></span>
<span>  <span class='co'># Intercept</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, alpha <span class='op'>=</span> <span class='fl'>.3</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># annotate</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, </span>
<span>           x <span class='op'>=</span> <span class='va'>contrats_1</span><span class='op'>$</span><span class='va'>tau</span>, </span>
<span>           y <span class='op'>=</span> <span class='va'>contrats_1</span><span class='op'>$</span><span class='va'>estimate</span>, hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.19</span>, </span>
<span>           label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>contrats_1</span><span class='op'>$</span><span class='va'>estimate</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>contrats_1</span><span class='op'>$</span><span class='va'>p</span> <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="qr2_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<hr />
<p>If you think, I missed something, please comment on it, and I’ll improve this tutorial.</p>
<p><strong>Thank you for learning!</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2024-01-04-qr2/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Unleash%20Quantile%20Regression%20Results&amp;url=https%3A%2F%2Fme.github.io%2Fposts%2F2024-01-04-qr2%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fme.github.io%2Fposts%2F2024-01-04-qr2%2F&amp;title=Unleash%20Quantile%20Regression%20Results" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fme.github.io%2Fposts%2F2024-01-04-qr2%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
      <a href="https://plus.google.com/share?url=https%3A%2F%2Fme.github.io%2Fposts%2F2024-01-04-qr2%2F" aria-label="share on google-plus">
        <i class="fab fa-google-plus" aria-hidden="true"></i>
      </a>
      <a href="https://pinterest.com/pin/create/link/?url=https%3A%2F%2Fme.github.io%2Fposts%2F2024-01-04-qr2%2F&amp;description=Unleash%20Quantile%20Regression%20Results" aria-label="share on pinterest">
        <i class="fab fa-pinterest" aria-hidden="true"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://yuzar-blog.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://me.github.io/posts/2024-01-04-qr2/';
  this.page.identifier = 'posts/2024-01-04-qr2/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://yuzar-blog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/yuryzablotski/yuzaR-Blog/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/yuryzablotski/yuzaR-Blog">https://github.com/yuryzablotski/yuzaR-Blog</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Zablotski (2024, Jan. 14). yuzaR-Blog: Unleash Quantile Regression Results. Retrieved from https://me.github.io/posts/2024-01-04-qr2/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{zablotski2024unleash,
  author = {Zablotski, Yury},
  title = {yuzaR-Blog: Unleash Quantile Regression Results},
  url = {https://me.github.io/posts/2024-01-04-qr2/},
  year = {2024}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
